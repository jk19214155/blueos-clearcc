     1 00000000                                 [FORMAT "WCOFF"]
     2 00000000                                 [INSTRSET "i486p"]
     3 00000000                                 [OPTIMIZE 1]
     4 00000000                                 [OPTION 1]
     5 00000000                                 [BITS 32]
     6 00000000                                 	EXTERN	_io_load_eflags
     7 00000000                                 	EXTERN	_io_store_eflags
     8 00000000                                 	EXTERN	_memtest_sub
     9 00000000                                 	EXTERN	_load_cr0
    10 00000000                                 	EXTERN	_store_cr0
    11 00000000                                 [FILE "memory.c"]
    12                                          [SECTION .text]
    13 00000000                                 	GLOBAL	_memtest
    14 00000000                                 _memtest:
    15 00000000 55                              	PUSH	EBP
    16 00000001 89 E5                           	MOV	EBP,ESP
    17 00000003 56                              	PUSH	ESI
    18 00000004 53                              	PUSH	EBX
    19 00000005 31 F6                           	XOR	ESI,ESI
    20 00000007 E8 [00000000]                   	CALL	_io_load_eflags
    21 0000000C 0D 00040000                     	OR	EAX,262144
    22 00000011 50                              	PUSH	EAX
    23 00000012 E8 [00000000]                   	CALL	_io_store_eflags
    24 00000017 E8 [00000000]                   	CALL	_io_load_eflags
    25 0000001C 5A                              	POP	EDX
    26 0000001D A9 00040000                     	TEST	EAX,262144
    27 00000022 74 05                           	JE	L2
    28 00000024 BE 00000001                     	MOV	ESI,1
    29 00000029                                 L2:
    30 00000029 25 FFFBFFFF                     	AND	EAX,-262145
    31 0000002E 50                              	PUSH	EAX
    32 0000002F E8 [00000000]                   	CALL	_io_store_eflags
    33 00000034 58                              	POP	EAX
    34 00000035 89 F0                           	MOV	EAX,ESI
    35 00000037 84 C0                           	TEST	AL,AL
    36 00000039 75 31                           	JNE	L5
    37 0000003B                                 L3:
    38 0000003B FF 75 0C                        	PUSH	DWORD [12+EBP]
    39 0000003E FF 75 08                        	PUSH	DWORD [8+EBP]
    40 00000041 E8 [00000000]                   	CALL	_memtest_sub
    41 00000046 5A                              	POP	EDX
    42 00000047 89 C3                           	MOV	EBX,EAX
    43 00000049 59                              	POP	ECX
    44 0000004A 89 F0                           	MOV	EAX,ESI
    45 0000004C 84 C0                           	TEST	AL,AL
    46 0000004E 75 09                           	JNE	L6
    47 00000050                                 L4:
    48 00000050 8D 65 F8                        	LEA	ESP,DWORD [-8+EBP]
    49 00000053 89 D8                           	MOV	EAX,EBX
    50 00000055 5B                              	POP	EBX
    51 00000056 5E                              	POP	ESI
    52 00000057 5D                              	POP	EBP
    53 00000058 C3                              	RET
    54 00000059                                 L6:
    55 00000059 E8 [00000000]                   	CALL	_load_cr0
    56 0000005E 25 9FFFFFFF                     	AND	EAX,-1610612737
    57 00000063 50                              	PUSH	EAX
    58 00000064 E8 [00000000]                   	CALL	_store_cr0
    59 00000069 58                              	POP	EAX
    60 0000006A EB E4                           	JMP	L4
    61 0000006C                                 L5:
    62 0000006C E8 [00000000]                   	CALL	_load_cr0
    63 00000071 0D 60000000                     	OR	EAX,1610612736
    64 00000076 50                              	PUSH	EAX
    65 00000077 E8 [00000000]                   	CALL	_store_cr0
    66 0000007C 5B                              	POP	EBX
    67 0000007D EB BC                           	JMP	L3
    68 0000007F                                 	GLOBAL	_memman_init
    69 0000007F                                 _memman_init:
    70 0000007F 55                              	PUSH	EBP
    71 00000080 89 E5                           	MOV	EBP,ESP
    72 00000082 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
    73 00000085 C7 00 00000000                  	MOV	DWORD [EAX],0
    74 0000008B C7 40 04 00000000               	MOV	DWORD [4+EAX],0
    75 00000092 C7 40 08 00000000               	MOV	DWORD [8+EAX],0
    76 00000099 C7 40 0C 00000000               	MOV	DWORD [12+EAX],0
    77 000000A0 5D                              	POP	EBP
    78 000000A1 C3                              	RET
    79 000000A2                                 	GLOBAL	_memman_total
    80 000000A2                                 _memman_total:
    81 000000A2 55                              	PUSH	EBP
    82 000000A3 31 C0                           	XOR	EAX,EAX
    83 000000A5 89 E5                           	MOV	EBP,ESP
    84 000000A7 31 D2                           	XOR	EDX,EDX
    85 000000A9 53                              	PUSH	EBX
    86 000000AA 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
    87 000000AD 8B 0B                           	MOV	ECX,DWORD [EBX]
    88 000000AF 39 C8                           	CMP	EAX,ECX
    89 000000B1 73 09                           	JAE	L15
    90 000000B3                                 L13:
    91 000000B3 03 44 D3 14                     	ADD	EAX,DWORD [20+EBX+EDX*8]
    92 000000B7 42                              	INC	EDX
    93 000000B8 39 CA                           	CMP	EDX,ECX
    94 000000BA 72 F7                           	JB	L13
    95 000000BC                                 L15:
    96 000000BC 5B                              	POP	EBX
    97 000000BD 5D                              	POP	EBP
    98 000000BE C3                              	RET
    99 000000BF                                 	GLOBAL	_memman_alloc
   100 000000BF                                 _memman_alloc:
   101 000000BF 55                              	PUSH	EBP
   102 000000C0 31 C9                           	XOR	ECX,ECX
   103 000000C2 89 E5                           	MOV	EBP,ESP
   104 000000C4 57                              	PUSH	EDI
   105 000000C5 56                              	PUSH	ESI
   106 000000C6 53                              	PUSH	EBX
   107 000000C7 8B 75 0C                        	MOV	ESI,DWORD [12+EBP]
   108 000000CA 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   109 000000CD 8B 03                           	MOV	EAX,DWORD [EBX]
   110 000000CF 39 C1                           	CMP	ECX,EAX
   111 000000D1 73 0D                           	JAE	L30
   112 000000D3                                 L28:
   113 000000D3 8B 54 CB 14                     	MOV	EDX,DWORD [20+EBX+ECX*8]
   114 000000D7 39 F2                           	CMP	EDX,ESI
   115 000000D9 73 0C                           	JAE	L32
   116 000000DB 41                              	INC	ECX
   117 000000DC 39 C1                           	CMP	ECX,EAX
   118 000000DE 72 F3                           	JB	L28
   119 000000E0                                 L30:
   120 000000E0 31 C0                           	XOR	EAX,EAX
   121 000000E2                                 L16:
   122 000000E2 5B                              	POP	EBX
   123 000000E3 5E                              	POP	ESI
   124 000000E4 5F                              	POP	EDI
   125 000000E5 5D                              	POP	EBP
   126 000000E6 C3                              	RET
   127 000000E7                                 L32:
   128 000000E7 8B 7C CB 10                     	MOV	EDI,DWORD [16+EBX+ECX*8]
   129 000000EB 8D 04 3E                        	LEA	EAX,DWORD [ESI+EDI*1]
   130 000000EE 89 44 CB 10                     	MOV	DWORD [16+EBX+ECX*8],EAX
   131 000000F2 89 D0                           	MOV	EAX,EDX
   132 000000F4 29 F0                           	SUB	EAX,ESI
   133 000000F6 89 44 CB 14                     	MOV	DWORD [20+EBX+ECX*8],EAX
   134 000000FA 85 C0                           	TEST	EAX,EAX
   135 000000FC 75 20                           	JNE	L22
   136 000000FE 8B 03                           	MOV	EAX,DWORD [EBX]
   137 00000100 48                              	DEC	EAX
   138 00000101 89 03                           	MOV	DWORD [EBX],EAX
   139 00000103 39 C1                           	CMP	ECX,EAX
   140 00000105 73 17                           	JAE	L22
   141 00000107 89 C6                           	MOV	ESI,EAX
   142 00000109                                 L27:
   143 00000109 8B 44 CB 18                     	MOV	EAX,DWORD [24+EBX+ECX*8]
   144 0000010D 8B 54 CB 1C                     	MOV	EDX,DWORD [28+EBX+ECX*8]
   145 00000111 89 44 CB 10                     	MOV	DWORD [16+EBX+ECX*8],EAX
   146 00000115 89 54 CB 14                     	MOV	DWORD [20+EBX+ECX*8],EDX
   147 00000119 41                              	INC	ECX
   148 0000011A 39 F1                           	CMP	ECX,ESI
   149 0000011C 72 EB                           	JB	L27
   150 0000011E                                 L22:
   151 0000011E 89 F8                           	MOV	EAX,EDI
   152 00000120 EB C0                           	JMP	L16
   153 00000122                                 	GLOBAL	_memman_free
   154 00000122                                 _memman_free:
   155 00000122 55                              	PUSH	EBP
   156 00000123 89 E5                           	MOV	EBP,ESP
   157 00000125 57                              	PUSH	EDI
   158 00000126 56                              	PUSH	ESI
   159 00000127 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   160 0000012A 53                              	PUSH	EBX
   161 0000012B 31 DB                           	XOR	EBX,EBX
   162 0000012D 8B 3E                           	MOV	EDI,DWORD [ESI]
   163 0000012F 39 FB                           	CMP	EBX,EDI
   164 00000131 7D 0E                           	JGE	L35
   165 00000133                                 L39:
   166 00000133 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   167 00000136 39 44 DE 10                     	CMP	DWORD [16+ESI+EBX*8],EAX
   168 0000013A 77 05                           	JA	L35
   169 0000013C 43                              	INC	EBX
   170 0000013D 39 FB                           	CMP	EBX,EDI
   171 0000013F 7C F2                           	JL	L39
   172 00000141                                 L35:
   173 00000141 85 DB                           	TEST	EBX,EBX
   174 00000143 7E 0F                           	JLE	L40
   175 00000145 8B 54 DE 0C                     	MOV	EDX,DWORD [12+ESI+EBX*8]
   176 00000149 8B 44 DE 08                     	MOV	EAX,DWORD [8+ESI+EBX*8]
   177 0000014D 01 D0                           	ADD	EAX,EDX
   178 0000014F 3B 45 0C                        	CMP	EAX,DWORD [12+EBP]
   179 00000152 74 73                           	JE	L63
   180 00000154                                 L40:
   181 00000154 39 FB                           	CMP	EBX,EDI
   182 00000156 7D 0C                           	JGE	L49
   183 00000158 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   184 0000015B 03 45 10                        	ADD	EAX,DWORD [16+EBP]
   185 0000015E 3B 44 DE 10                     	CMP	EAX,DWORD [16+ESI+EBX*8]
   186 00000162 74 53                           	JE	L64
   187 00000164                                 L49:
   188 00000164 81 FF 00000FF9                  	CMP	EDI,4089
   189 0000016A 7F 3D                           	JG	L51
   190 0000016C 89 F9                           	MOV	ECX,EDI
   191 0000016E 39 DF                           	CMP	EDI,EBX
   192 00000170 7E 15                           	JLE	L61
   193 00000172                                 L56:
   194 00000172 8B 44 CE 08                     	MOV	EAX,DWORD [8+ESI+ECX*8]
   195 00000176 8B 54 CE 0C                     	MOV	EDX,DWORD [12+ESI+ECX*8]
   196 0000017A 89 44 CE 10                     	MOV	DWORD [16+ESI+ECX*8],EAX
   197 0000017E 89 54 CE 14                     	MOV	DWORD [20+ESI+ECX*8],EDX
   198 00000182 49                              	DEC	ECX
   199 00000183 39 D9                           	CMP	ECX,EBX
   200 00000185 7F EB                           	JG	L56
   201 00000187                                 L61:
   202 00000187 8D 47 01                        	LEA	EAX,DWORD [1+EDI]
   203 0000018A 89 06                           	MOV	DWORD [ESI],EAX
   204 0000018C 39 46 04                        	CMP	DWORD [4+ESI],EAX
   205 0000018F 7D 03                           	JGE	L57
   206 00000191 89 46 04                        	MOV	DWORD [4+ESI],EAX
   207 00000194                                 L57:
   208 00000194 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   209 00000197 89 44 DE 10                     	MOV	DWORD [16+ESI+EBX*8],EAX
   210 0000019B 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   211 0000019E 89 44 DE 14                     	MOV	DWORD [20+ESI+EBX*8],EAX
   212 000001A2                                 L62:
   213 000001A2 31 C0                           	XOR	EAX,EAX
   214 000001A4                                 L33:
   215 000001A4 5B                              	POP	EBX
   216 000001A5 5E                              	POP	ESI
   217 000001A6 5F                              	POP	EDI
   218 000001A7 5D                              	POP	EBP
   219 000001A8 C3                              	RET
   220 000001A9                                 L51:
   221 000001A9 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   222 000001AC FF 46 0C                        	INC	DWORD [12+ESI]
   223 000001AF 01 46 08                        	ADD	DWORD [8+ESI],EAX
   224 000001B2 83 C8 FF                        	OR	EAX,-1
   225 000001B5 EB ED                           	JMP	L33
   226 000001B7                                 L64:
   227 000001B7 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   228 000001BA 89 44 DE 10                     	MOV	DWORD [16+ESI+EBX*8],EAX
   229 000001BE 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   230 000001C1 01 44 DE 14                     	ADD	DWORD [20+ESI+EBX*8],EAX
   231 000001C5 EB DB                           	JMP	L62
   232 000001C7                                 L63:
   233 000001C7 03 55 10                        	ADD	EDX,DWORD [16+EBP]
   234 000001CA 89 54 DE 0C                     	MOV	DWORD [12+ESI+EBX*8],EDX
   235 000001CE 3B 1E                           	CMP	EBX,DWORD [ESI]
   236 000001D0 7D D0                           	JGE	L62
   237 000001D2 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   238 000001D5 03 45 10                        	ADD	EAX,DWORD [16+EBP]
   239 000001D8 3B 44 DE 10                     	CMP	EAX,DWORD [16+ESI+EBX*8]
   240 000001DC 75 C4                           	JNE	L62
   241 000001DE 03 54 DE 14                     	ADD	EDX,DWORD [20+ESI+EBX*8]
   242 000001E2 89 54 DE 0C                     	MOV	DWORD [12+ESI+EBX*8],EDX
   243 000001E6 8B 06                           	MOV	EAX,DWORD [ESI]
   244 000001E8 48                              	DEC	EAX
   245 000001E9 89 06                           	MOV	DWORD [ESI],EAX
   246 000001EB 39 C3                           	CMP	EBX,EAX
   247 000001ED 7D B3                           	JGE	L62
   248 000001EF 89 C1                           	MOV	ECX,EAX
   249 000001F1                                 L48:
   250 000001F1 8B 44 DE 18                     	MOV	EAX,DWORD [24+ESI+EBX*8]
   251 000001F5 8B 54 DE 1C                     	MOV	EDX,DWORD [28+ESI+EBX*8]
   252 000001F9 89 44 DE 10                     	MOV	DWORD [16+ESI+EBX*8],EAX
   253 000001FD 89 54 DE 14                     	MOV	DWORD [20+ESI+EBX*8],EDX
   254 00000201 43                              	INC	EBX
   255 00000202 39 CB                           	CMP	EBX,ECX
   256 00000204 7C EB                           	JL	L48
   257 00000206 EB 9A                           	JMP	L62
   258 00000208                                 	GLOBAL	_memman_alloc_4k
   259 00000208                                 _memman_alloc_4k:
   260 00000208 55                              	PUSH	EBP
   261 00000209 89 E5                           	MOV	EBP,ESP
   262 0000020B 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   263 0000020E 05 00000FFF                     	ADD	EAX,4095
   264 00000213 25 FFFFF000                     	AND	EAX,-4096
   265 00000218 89 45 0C                        	MOV	DWORD [12+EBP],EAX
   266 0000021B 5D                              	POP	EBP
   267 0000021C E9 FFFFFE9E                     	JMP	_memman_alloc
   268 00000221                                 	GLOBAL	_memman_free_4k
   269 00000221                                 _memman_free_4k:
   270 00000221 55                              	PUSH	EBP
   271 00000222 89 E5                           	MOV	EBP,ESP
   272 00000224 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   273 00000227 05 00000FFF                     	ADD	EAX,4095
   274 0000022C 25 FFFFF000                     	AND	EAX,-4096
   275 00000231 89 45 10                        	MOV	DWORD [16+EBP],EAX
   276 00000234 5D                              	POP	EBP
   277 00000235 E9 FFFFFEE8                     	JMP	_memman_free
   278 0000023A                                 	GLOBAL	_init_page
   279 0000023A                                 _init_page:
   280 0000023A 55                              	PUSH	EBP
   281 0000023B 89 E5                           	MOV	EBP,ESP
   282 0000023D 57                              	PUSH	EDI
   283 0000023E 56                              	PUSH	ESI
   284 0000023F 53                              	PUSH	EBX
   285 00000240 BB 00400000                     	MOV	EBX,4194304
   286 00000245 56                              	PUSH	ESI
   287 00000246 56                              	PUSH	ESI
   288 00000247                                 L72:
   289 00000247 C7 03 00000000                  	MOV	DWORD [EBX],0
   290 0000024D 83 C3 04                        	ADD	EBX,4
   291 00000250 81 FB 007FFFFF                  	CMP	EBX,8388607
   292 00000256 7E EF                           	JLE	L72
   293 00000258 BB 00268000                     	MOV	EBX,2523136
   294 0000025D BA 00400000                     	MOV	EDX,4194304
   295 00000262                                 L77:
   296 00000262 89 D0                           	MOV	EAX,EDX
   297 00000264 81 C2 00001000                  	ADD	EDX,4096
   298 0000026A 83 C8 07                        	OR	EAX,7
   299 0000026D 89 03                           	MOV	DWORD [EBX],EAX
   300 0000026F 83 C3 04                        	ADD	EBX,4
   301 00000272 81 FB 00268FFF                  	CMP	EBX,2527231
   302 00000278 7E E8                           	JLE	L77
   303 0000027A BB 00269000                     	MOV	EBX,2527232
   304 0000027F 31 D2                           	XOR	EDX,EDX
   305 00000281                                 L82:
   306 00000281 89 D0                           	MOV	EAX,EDX
   307 00000283 81 C2 00400000                  	ADD	EDX,4194304
   308 00000289 0D 00000187                     	OR	EAX,391
   309 0000028E 89 03                           	MOV	DWORD [EBX],EAX
   310 00000290 83 C3 04                        	ADD	EBX,4
   311 00000293 81 FB 00269FFF                  	CMP	EBX,2531327
   312 00000299 7E E6                           	JLE	L82
   313 0000029B 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   314 0000029E 31 DB                           	XOR	EBX,EBX
   315 000002A0 C7 40 08 00800000               	MOV	DWORD [8+EAX],8388608
   316 000002A7                                 L87:
   317 000002A7 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   318 000002AA 8B 42 08                        	MOV	EAX,DWORD [8+EDX]
   319 000002AD C6 04 03 FF                     	MOV	BYTE [EBX+EAX*1],-1
   320 000002B1 43                              	INC	EBX
   321 000002B2 81 FB 000FFFFF                  	CMP	EBX,1048575
   322 000002B8 7E ED                           	JLE	L87
   323 000002BA C7 42 04 00000000               	MOV	DWORD [4+EDX],0
   324 000002C1 C7 02 00000000                  	MOV	DWORD [EDX],0
   325 000002C7 31 DB                           	XOR	EBX,EBX
   326 000002C9 31 FF                           	XOR	EDI,EDI
   327 000002CB                                 L105:
   328 000002CB 39 9F 0026A014                  	CMP	DWORD [2531348+EDI],EBX
   329 000002D1 0F 85 000000B1                  	JNE	L92
   330 000002D7 83 BF 0026A004 00               	CMP	DWORD [2531332+EDI],0
   331 000002DE 7E 30                           	JLE	L125
   332 000002E0                                 L90:
   333 000002E0 43                              	INC	EBX
   334 000002E1 83 C7 20                        	ADD	EDI,32
   335 000002E4 83 FB 7F                        	CMP	EBX,127
   336 000002E7 7E E2                           	JLE	L105
   337 000002E9                                 L89:
   338 000002E9 BB 00000001                     	MOV	EBX,1
   339 000002EE                                 L111:
   340 000002EE 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   341 000002F1 8B 46 08                        	MOV	EAX,DWORD [8+ESI]
   342 000002F4 80 3C 03 00                     	CMP	BYTE [EBX+EAX*1],0
   343 000002F8 75 02                           	JNE	L110
   344 000002FA FF 0E                           	DEC	DWORD [ESI]
   345 000002FC                                 L110:
   346 000002FC C6 04 03 FF                     	MOV	BYTE [EBX+EAX*1],-1
   347 00000300 43                              	INC	EBX
   348 00000301 81 FB 000008FF                  	CMP	EBX,2303
   349 00000307 7E E5                           	JLE	L111
   350 00000309 59                              	POP	ECX
   351 0000030A 5B                              	POP	EBX
   352 0000030B 5B                              	POP	EBX
   353 0000030C 5E                              	POP	ESI
   354 0000030D 5F                              	POP	EDI
   355 0000030E 5D                              	POP	EBP
   356 0000030F C3                              	RET
   357 00000310                                 L125:
   358 00000310 8B 97 0026A000                  	MOV	EDX,DWORD [2531328+EDI]
   359 00000316 89 D1                           	MOV	ECX,EDX
   360 00000318 03 8F 0026A008                  	ADD	ECX,DWORD [2531336+EDI]
   361 0000031E 83 BF 0026A010 01               	CMP	DWORD [2531344+EDI],1
   362 00000325 74 53                           	JE	L94
   363 00000327 81 E2 FFFFF000                  	AND	EDX,-4096
   364 0000032D 81 C1 00000FFF                  	ADD	ECX,4095
   365 00000333                                 L124:
   366 00000333 81 E1 FFFFF000                  	AND	ECX,-4096
   367 00000339 31 C0                           	XOR	EAX,EAX
   368 0000033B C1 F9 0C                        	SAR	ECX,12
   369 0000033E 83 BF 0026A010 01               	CMP	DWORD [2531344+EDI],1
   370 00000345 0F 94 C0                        	SETE	AL
   371 00000348 C1 FA 0C                        	SAR	EDX,12
   372 0000034B 48                              	DEC	EAX
   373 0000034C 89 45 EC                        	MOV	DWORD [-20+EBP],EAX
   374 0000034F 39 CA                           	CMP	EDX,ECX
   375 00000351 7F 8D                           	JG	L90
   376 00000353                                 L103:
   377 00000353 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   378 00000356 8A 45 EC                        	MOV	AL,BYTE [-20+EBP]
   379 00000359 8B 76 08                        	MOV	ESI,DWORD [8+ESI]
   380 0000035C 88 04 32                        	MOV	BYTE [EDX+ESI*1],AL
   381 0000035F 83 7D EC 00                     	CMP	DWORD [-20+EBP],0
   382 00000363 75 05                           	JNE	L102
   383 00000365 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   384 00000368 FF 06                           	INC	DWORD [ESI]
   385 0000036A                                 L102:
   386 0000036A 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   387 0000036D 42                              	INC	EDX
   388 0000036E FF 40 04                        	INC	DWORD [4+EAX]
   389 00000371 39 CA                           	CMP	EDX,ECX
   390 00000373 7E DE                           	JLE	L103
   391 00000375 E9 FFFFFF66                     	JMP	L90
   392 0000037A                                 L94:
   393 0000037A 81 C2 00000FFF                  	ADD	EDX,4095
   394 00000380 81 E2 FFFFF000                  	AND	EDX,-4096
   395 00000386 EB AB                           	JMP	L124
   396 00000388                                 L92:
   397 00000388 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   398 0000038B 8B 42 04                        	MOV	EAX,DWORD [4+EDX]
   399 0000038E A3 0026F004                     	MOV	DWORD [2551812],EAX
   400 00000393 8B 02                           	MOV	EAX,DWORD [EDX]
   401 00000395 A3 0026F008                     	MOV	DWORD [2551816],EAX
   402 0000039A E9 FFFFFF4A                     	JMP	L89
   403 0000039F                                 	GLOBAL	_memmam_link_page_32_m
   404 0000039F                                 _memmam_link_page_32_m:
   405 0000039F 55                              	PUSH	EBP
   406 000003A0 89 E5                           	MOV	EBP,ESP
   407 000003A2 57                              	PUSH	EDI
   408 000003A3 56                              	PUSH	ESI
   409 000003A4 53                              	PUSH	EBX
   410 000003A5 8B 7D 18                        	MOV	EDI,DWORD [24+EBP]
   411 000003A8 83 7D 1C 00                     	CMP	DWORD [28+EBP],0
   412 000003AC 75 3E                           	JNE	L127
   413 000003AE 31 F6                           	XOR	ESI,ESI
   414 000003B0 39 FE                           	CMP	ESI,EDI
   415 000003B2 7D 23                           	JGE	L133
   416 000003B4 8B 5D 10                        	MOV	EBX,DWORD [16+EBP]
   417 000003B7                                 L132:
   418 000003B7 FF 75 1C                        	PUSH	DWORD [28+EBP]
   419 000003BA FF 75 14                        	PUSH	DWORD [20+EBP]
   420 000003BD 53                              	PUSH	EBX
   421 000003BE 46                              	INC	ESI
   422 000003BF FF 75 0C                        	PUSH	DWORD [12+EBP]
   423 000003C2 FF 75 08                        	PUSH	DWORD [8+EBP]
   424 000003C5 81 C3 00001000                  	ADD	EBX,4096
   425 000003CB E8 0000004C                     	CALL	_memman_link_page_32
   426 000003D0 83 C4 14                        	ADD	ESP,20
   427 000003D3 39 FE                           	CMP	ESI,EDI
   428 000003D5 7C E0                           	JL	L132
   429 000003D7                                 L133:
   430 000003D7 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   431 000003DA 8B 02                           	MOV	EAX,DWORD [EDX]
   432 000003DC A3 0026F00C                     	MOV	DWORD [2551820],EAX
   433 000003E1 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
   434 000003E4 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   435 000003E7 5B                              	POP	EBX
   436 000003E8 5E                              	POP	ESI
   437 000003E9 5F                              	POP	EDI
   438 000003EA 5D                              	POP	EBP
   439 000003EB C3                              	RET
   440 000003EC                                 L127:
   441 000003EC 85 FF                           	TEST	EDI,EDI
   442 000003EE 7E E7                           	JLE	L133
   443 000003F0 31 DB                           	XOR	EBX,EBX
   444 000003F2 89 FE                           	MOV	ESI,EDI
   445 000003F4                                 L138:
   446 000003F4 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
   447 000003F7 FF 75 1C                        	PUSH	DWORD [28+EBP]
   448 000003FA 01 D8                           	ADD	EAX,EBX
   449 000003FC 50                              	PUSH	EAX
   450 000003FD 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   451 00000400 01 D8                           	ADD	EAX,EBX
   452 00000402 81 C3 00001000                  	ADD	EBX,4096
   453 00000408 50                              	PUSH	EAX
   454 00000409 FF 75 0C                        	PUSH	DWORD [12+EBP]
   455 0000040C FF 75 08                        	PUSH	DWORD [8+EBP]
   456 0000040F E8 00000008                     	CALL	_memman_link_page_32
   457 00000414 83 C4 14                        	ADD	ESP,20
   458 00000417 4E                              	DEC	ESI
   459 00000418 75 DA                           	JNE	L138
   460 0000041A EB BB                           	JMP	L133
   461 0000041C                                 	GLOBAL	_memman_link_page_32
   462 0000041C                                 _memman_link_page_32:
   463 0000041C 55                              	PUSH	EBP
   464 0000041D 89 E5                           	MOV	EBP,ESP
   465 0000041F 56                              	PUSH	ESI
   466 00000420 53                              	PUSH	EBX
   467 00000421 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   468 00000424 8B 55 14                        	MOV	EDX,DWORD [20+EBP]
   469 00000427 89 C6                           	MOV	ESI,EAX
   470 00000429 C1 E8 0A                        	SHR	EAX,10
   471 0000042C C1 EE 14                        	SHR	ESI,20
   472 0000042F 25 00000FFC                     	AND	EAX,4092
   473 00000434 81 E6 00000FFC                  	AND	ESI,4092
   474 0000043A 03 75 0C                        	ADD	ESI,DWORD [12+EBP]
   475 0000043D 8B 36                           	MOV	ESI,DWORD [ESI]
   476 0000043F 81 E6 FFFFF000                  	AND	ESI,-4096
   477 00000445 01 C6                           	ADD	ESI,EAX
   478 00000447 83 7D 18 00                     	CMP	DWORD [24+EBP],0
   479 0000044B 74 0B                           	JE	L144
   480 0000044D                                 L143:
   481 0000044D 89 16                           	MOV	DWORD [ESI],EDX
   482 0000044F 89 D0                           	MOV	EAX,EDX
   483 00000451 8D 65 F8                        	LEA	ESP,DWORD [-8+EBP]
   484 00000454 5B                              	POP	EBX
   485 00000455 5E                              	POP	ESI
   486 00000456 5D                              	POP	EBP
   487 00000457 C3                              	RET
   488 00000458                                 L144:
   489 00000458 FF 75 08                        	PUSH	DWORD [8+EBP]
   490 0000045B 89 D3                           	MOV	EBX,EDX
   491 0000045D E8 0000003C                     	CALL	_memman_alloc_page_32
   492 00000462 81 E3 00000FFF                  	AND	EBX,4095
   493 00000468 89 C2                           	MOV	EDX,EAX
   494 0000046A 09 DA                           	OR	EDX,EBX
   495 0000046C EB DF                           	JMP	L143
   496 0000046E                                 	GLOBAL	_memman_unlink_page_32
   497 0000046E                                 _memman_unlink_page_32:
   498 0000046E 55                              	PUSH	EBP
   499 0000046F 89 E5                           	MOV	EBP,ESP
   500 00000471 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   501 00000474 89 C2                           	MOV	EDX,EAX
   502 00000476 C1 E8 0A                        	SHR	EAX,10
   503 00000479 C1 EA 14                        	SHR	EDX,20
   504 0000047C 25 00000FFC                     	AND	EAX,4092
   505 00000481 81 E2 00000FFC                  	AND	EDX,4092
   506 00000487 03 55 0C                        	ADD	EDX,DWORD [12+EBP]
   507 0000048A 8B 12                           	MOV	EDX,DWORD [EDX]
   508 0000048C 81 E2 FFFFF000                  	AND	EDX,-4096
   509 00000492 01 C2                           	ADD	EDX,EAX
   510 00000494 8B 02                           	MOV	EAX,DWORD [EDX]
   511 00000496 C7 02 00000000                  	MOV	DWORD [EDX],0
   512 0000049C 5D                              	POP	EBP
   513 0000049D C3                              	RET
   514 0000049E                                 	GLOBAL	_memman_alloc_page_32
   515 0000049E                                 _memman_alloc_page_32:
   516 0000049E 55                              	PUSH	EBP
   517 0000049F 31 C0                           	XOR	EAX,EAX
   518 000004A1 89 E5                           	MOV	EBP,ESP
   519 000004A3 8B 4D 08                        	MOV	ECX,DWORD [8+EBP]
   520 000004A6                                 L153:
   521 000004A6 8B 51 08                        	MOV	EDX,DWORD [8+ECX]
   522 000004A9 80 3C 10 00                     	CMP	BYTE [EAX+EDX*1],0
   523 000004AD 74 11                           	JE	L157
   524 000004AF 40                              	INC	EAX
   525 000004B0 3D 000FFFFF                     	CMP	EAX,1048575
   526 000004B5 7E EF                           	JLE	L153
   527 000004B7 8B 01                           	MOV	EAX,DWORD [ECX]
   528 000004B9 A3 0026F010                     	MOV	DWORD [2551824],EAX
   529 000004BE                                 L154:
   530 000004BE EB FE                           	JMP	L154
   531 000004C0                                 L157:
   532 000004C0 C6 04 10 01                     	MOV	BYTE [EAX+EDX*1],1
   533 000004C4 C1 E0 0C                        	SAL	EAX,12
   534 000004C7 FF 09                           	DEC	DWORD [ECX]
   535 000004C9 5D                              	POP	EBP
   536 000004CA C3                              	RET
   537 000004CB                                 	GLOBAL	_memman_free_page_32_m
   538 000004CB                                 _memman_free_page_32_m:
   539 000004CB 55                              	PUSH	EBP
   540 000004CC 31 C9                           	XOR	ECX,ECX
   541 000004CE 89 E5                           	MOV	EBP,ESP
   542 000004D0 57                              	PUSH	EDI
   543 000004D1 56                              	PUSH	ESI
   544 000004D2 53                              	PUSH	EBX
   545 000004D3 8B 7D 10                        	MOV	EDI,DWORD [16+EBP]
   546 000004D6 8B 5D 0C                        	MOV	EBX,DWORD [12+EBP]
   547 000004D9 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   548 000004DC C1 EB 0C                        	SHR	EBX,12
   549 000004DF 39 F9                           	CMP	ECX,EDI
   550 000004E1 7D 15                           	JGE	L168
   551 000004E3                                 L166:
   552 000004E3 8B 56 08                        	MOV	EDX,DWORD [8+ESI]
   553 000004E6 8D 04 19                        	LEA	EAX,DWORD [ECX+EBX*1]
   554 000004E9 80 3C 10 01                     	CMP	BYTE [EAX+EDX*1],1
   555 000004ED 74 10                           	JE	L169
   556 000004EF                                 L165:
   557 000004EF 41                              	INC	ECX
   558 000004F0 C6 04 10 00                     	MOV	BYTE [EAX+EDX*1],0
   559 000004F4 39 F9                           	CMP	ECX,EDI
   560 000004F6 7C EB                           	JL	L166
   561 000004F8                                 L168:
   562 000004F8 5B                              	POP	EBX
   563 000004F9 31 C0                           	XOR	EAX,EAX
   564 000004FB 5E                              	POP	ESI
   565 000004FC 5F                              	POP	EDI
   566 000004FD 5D                              	POP	EBP
   567 000004FE C3                              	RET
   568 000004FF                                 L169:
   569 000004FF FF 06                           	INC	DWORD [ESI]
   570 00000501 EB EC                           	JMP	L165
   571 00000503                                 	GLOBAL	_memman_free_page_32
   572 00000503                                 _memman_free_page_32:
   573 00000503 55                              	PUSH	EBP
   574 00000504 89 E5                           	MOV	EBP,ESP
   575 00000506 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   576 00000509 8B 55 0C                        	MOV	EDX,DWORD [12+EBP]
   577 0000050C C1 EA 0C                        	SHR	EDX,12
   578 0000050F 8B 48 08                        	MOV	ECX,DWORD [8+EAX]
   579 00000512 80 3C 0A 01                     	CMP	BYTE [EDX+ECX*1],1
   580 00000516 74 0F                           	JE	L172
   581 00000518                                 L171:
   582 00000518 C6 04 0A 00                     	MOV	BYTE [EDX+ECX*1],0
   583 0000051C 8B 00                           	MOV	EAX,DWORD [EAX]
   584 0000051E A3 0026F00C                     	MOV	DWORD [2551820],EAX
   585 00000523 31 C0                           	XOR	EAX,EAX
   586 00000525 5D                              	POP	EBP
   587 00000526 C3                              	RET
   588 00000527                                 L172:
   589 00000527 FF 00                           	INC	DWORD [EAX]
   590 00000529 EB ED                           	JMP	L171
