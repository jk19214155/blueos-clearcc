     1 00000000                                 [FORMAT "WCOFF"]
     2 00000000                                 [INSTRSET "i486p"]
     3 00000000                                 [OPTIMIZE 1]
     4 00000000                                 [OPTION 1]
     5 00000000                                 [BITS 32]
     6 00000000                                 	EXTERN	_io_hlt
     7 00000000                                 	EXTERN	_memman_alloc_4k
     8 00000000                                 	EXTERN	_memmam_link_page_32_m
     9 00000000                                 	EXTERN	_set_segmdesc
    10 00000000                                 	EXTERN	_load_tr
    11 00000000                                 	EXTERN	_timer_alloc
    12 00000000                                 	EXTERN	_timer_settime
    13 00000000                                 	EXTERN	_farjmp
    14 00000000                                 [FILE "mtask.c"]
    15                                          [SECTION .text]
    16 00000000                                 	GLOBAL	_task_now
    17 00000000                                 _task_now:
    18 00000000 A1 [00000000]                   	MOV	EAX,DWORD [_taskctl]
    19 00000005 55                              	PUSH	EBP
    20 00000006 89 E5                           	MOV	EBP,ESP
    21 00000008 5D                              	POP	EBP
    22 00000009 8B 10                           	MOV	EDX,DWORD [EAX]
    23 0000000B 69 D2 00000198                  	IMUL	EDX,EDX,408
    24 00000011 8D 44 02 10                     	LEA	EAX,DWORD [16+EDX+EAX*1]
    25 00000015 8B 50 04                        	MOV	EDX,DWORD [4+EAX]
    26 00000018 8B 44 90 08                     	MOV	EAX,DWORD [8+EAX+EDX*4]
    27 0000001C C3                              	RET
    28 0000001D                                 	GLOBAL	_add_child_task
    29 0000001D                                 _add_child_task:
    30 0000001D 55                              	PUSH	EBP
    31 0000001E 89 E5                           	MOV	EBP,ESP
    32 00000020 53                              	PUSH	EBX
    33 00000021 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
    34 00000024 8B 4D 0C                        	MOV	ECX,DWORD [12+EBP]
    35 00000027 8B 83 000000F8                  	MOV	EAX,DWORD [248+EBX]
    36 0000002D 85 C0                           	TEST	EAX,EAX
    37 0000002F 75 15                           	JNE	L3
    38 00000031 89 8B 000000F8                  	MOV	DWORD [248+EBX],ECX
    39 00000037 89 89 000000F4                  	MOV	DWORD [244+ECX],ECX
    40 0000003D                                 L12:
    41 0000003D 89 99 000000FC                  	MOV	DWORD [252+ECX],EBX
    42 00000043 5B                              	POP	EBX
    43 00000044 5D                              	POP	EBP
    44 00000045 C3                              	RET
    45 00000046                                 L3:
    46 00000046 89 C2                           	MOV	EDX,EAX
    47 00000048 39 80 000000F4                  	CMP	DWORD [244+EAX],EAX
    48 0000004E 74 0E                           	JE	L11
    49 00000050                                 L9:
    50 00000050 8B 92 000000F4                  	MOV	EDX,DWORD [244+EDX]
    51 00000056 39 82 000000F4                  	CMP	DWORD [244+EDX],EAX
    52 0000005C 75 F2                           	JNE	L9
    53 0000005E                                 L11:
    54 0000005E 8B 82 000000F4                  	MOV	EAX,DWORD [244+EDX]
    55 00000064 89 81 000000F4                  	MOV	DWORD [244+ECX],EAX
    56 0000006A 89 8A 000000F4                  	MOV	DWORD [244+EDX],ECX
    57 00000070 EB CB                           	JMP	L12
    58 00000072                                 	GLOBAL	_find_child_task
    59 00000072                                 _find_child_task:
    60 00000072 55                              	PUSH	EBP
    61 00000073 89 E5                           	MOV	EBP,ESP
    62 00000075 53                              	PUSH	EBX
    63 00000076 31 DB                           	XOR	EBX,EBX
    64 00000078 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
    65 0000007B 8B 80 000000F8                  	MOV	EAX,DWORD [248+EAX]
    66 00000081 85 C0                           	TEST	EAX,EAX
    67 00000083 74 1C                           	JE	L13
    68 00000085                                 L23:
    69 00000085 89 C2                           	MOV	EDX,EAX
    70 00000087 89 C1                           	MOV	ECX,EAX
    71 00000089                                 L16:
    72 00000089 8B 82 000000F8                  	MOV	EAX,DWORD [248+EDX]
    73 0000008F 85 C0                           	TEST	EAX,EAX
    74 00000091 75 F2                           	JNE	L23
    75 00000093 8B 82 000000F4                  	MOV	EAX,DWORD [244+EDX]
    76 00000099 89 D3                           	MOV	EBX,EDX
    77 0000009B 39 C8                           	CMP	EAX,ECX
    78 0000009D 89 C2                           	MOV	EDX,EAX
    79 0000009F 75 E8                           	JNE	L16
    80 000000A1                                 L13:
    81 000000A1 89 D8                           	MOV	EAX,EBX
    82 000000A3 5B                              	POP	EBX
    83 000000A4 5D                              	POP	EBP
    84 000000A5 C3                              	RET
    85 000000A6                                 	GLOBAL	_unlink_task
    86 000000A6                                 _unlink_task:
    87 000000A6 55                              	PUSH	EBP
    88 000000A7 89 E5                           	MOV	EBP,ESP
    89 000000A9 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
    90 000000AC 83 B8 000000F8 00               	CMP	DWORD [248+EAX],0
    91 000000B3 75 2A                           	JNE	L24
    92 000000B5 89 C2                           	MOV	EDX,EAX
    93 000000B7 39 80 000000F4                  	CMP	DWORD [244+EAX],EAX
    94 000000BD 74 0E                           	JE	L35
    95 000000BF                                 L31:
    96 000000BF 8B 92 000000F4                  	MOV	EDX,DWORD [244+EDX]
    97 000000C5 39 82 000000F4                  	CMP	DWORD [244+EDX],EAX
    98 000000CB 75 F2                           	JNE	L31
    99 000000CD                                 L35:
   100 000000CD 39 C2                           	CMP	EDX,EAX
   101 000000CF 74 10                           	JE	L37
   102 000000D1 8B 80 000000F4                  	MOV	EAX,DWORD [244+EAX]
   103 000000D7 89 82 000000F4                  	MOV	DWORD [244+EDX],EAX
   104 000000DD                                 L36:
   105 000000DD 31 C0                           	XOR	EAX,EAX
   106 000000DF                                 L24:
   107 000000DF 5D                              	POP	EBP
   108 000000E0 C3                              	RET
   109 000000E1                                 L37:
   110 000000E1 8B 92 000000FC                  	MOV	EDX,DWORD [252+EDX]
   111 000000E7 C7 82 000000F8 00000000         	MOV	DWORD [248+EDX],0
   112 000000F1 EB EA                           	JMP	L36
   113 000000F3                                 	GLOBAL	_task_add
   114 000000F3                                 _task_add:
   115 000000F3 55                              	PUSH	EBP
   116 000000F4 89 E5                           	MOV	EBP,ESP
   117 000000F6 8B 4D 08                        	MOV	ECX,DWORD [8+EBP]
   118 000000F9 8B 51 08                        	MOV	EDX,DWORD [8+ECX]
   119 000000FC 69 D2 00000198                  	IMUL	EDX,EDX,408
   120 00000102 03 15 [00000000]                	ADD	EDX,DWORD [_taskctl]
   121 00000108 8B 42 10                        	MOV	EAX,DWORD [16+EDX]
   122 0000010B 89 4C 82 18                     	MOV	DWORD [24+EDX+EAX*4],ECX
   123 0000010F 40                              	INC	EAX
   124 00000110 89 42 10                        	MOV	DWORD [16+EDX],EAX
   125 00000113 C7 41 04 00000002               	MOV	DWORD [4+ECX],2
   126 0000011A 5D                              	POP	EBP
   127 0000011B C3                              	RET
   128 0000011C                                 	GLOBAL	_task_remove
   129 0000011C                                 _task_remove:
   130 0000011C 55                              	PUSH	EBP
   131 0000011D 89 E5                           	MOV	EBP,ESP
   132 0000011F 57                              	PUSH	EDI
   133 00000120 56                              	PUSH	ESI
   134 00000121 8B 7D 08                        	MOV	EDI,DWORD [8+EBP]
   135 00000124 53                              	PUSH	EBX
   136 00000125 8B 47 08                        	MOV	EAX,DWORD [8+EDI]
   137 00000128 69 C0 00000198                  	IMUL	EAX,EAX,408
   138 0000012E 03 05 [00000000]                	ADD	EAX,DWORD [_taskctl]
   139 00000134 8D 70 10                        	LEA	ESI,DWORD [16+EAX]
   140 00000137                                 L40:
   141 00000137 57                              	PUSH	EDI
   142 00000138 E8 FFFFFF35                     	CALL	_find_child_task
   143 0000013D 59                              	POP	ECX
   144 0000013E 89 C3                           	MOV	EBX,EAX
   145 00000140 85 C0                           	TEST	EAX,EAX
   146 00000142 74 10                           	JE	L46
   147 00000144 50                              	PUSH	EAX
   148 00000145 E8 FFFFFFD2                     	CALL	_task_remove
   149 0000014A 53                              	PUSH	EBX
   150 0000014B E8 FFFFFF56                     	CALL	_unlink_task
   151 00000150 58                              	POP	EAX
   152 00000151 5A                              	POP	EDX
   153 00000152 EB E3                           	JMP	L40
   154 00000154                                 L46:
   155 00000154 31 D2                           	XOR	EDX,EDX
   156 00000156 8B 06                           	MOV	EAX,DWORD [ESI]
   157 00000158 39 C2                           	CMP	EDX,EAX
   158 0000015A 7D 0B                           	JGE	L48
   159 0000015C                                 L52:
   160 0000015C 39 7C 96 08                     	CMP	DWORD [8+ESI+EDX*4],EDI
   161 00000160 74 05                           	JE	L48
   162 00000162 42                              	INC	EDX
   163 00000163 39 C2                           	CMP	EDX,EAX
   164 00000165 7C F5                           	JL	L52
   165 00000167                                 L48:
   166 00000167 48                              	DEC	EAX
   167 00000168 89 06                           	MOV	DWORD [ESI],EAX
   168 0000016A 8B 46 04                        	MOV	EAX,DWORD [4+ESI]
   169 0000016D 39 C2                           	CMP	EDX,EAX
   170 0000016F 7D 04                           	JGE	L53
   171 00000171 48                              	DEC	EAX
   172 00000172 89 46 04                        	MOV	DWORD [4+ESI],EAX
   173 00000175                                 L53:
   174 00000175 8B 06                           	MOV	EAX,DWORD [ESI]
   175 00000177 39 46 04                        	CMP	DWORD [4+ESI],EAX
   176 0000017A 7C 07                           	JL	L54
   177 0000017C C7 46 04 00000000               	MOV	DWORD [4+ESI],0
   178 00000183                                 L54:
   179 00000183 C7 47 04 00000001               	MOV	DWORD [4+EDI],1
   180 0000018A 8B 0E                           	MOV	ECX,DWORD [ESI]
   181 0000018C 39 CA                           	CMP	EDX,ECX
   182 0000018E 7D 0D                           	JGE	L62
   183 00000190                                 L59:
   184 00000190 8B 44 96 0C                     	MOV	EAX,DWORD [12+ESI+EDX*4]
   185 00000194 89 44 96 08                     	MOV	DWORD [8+ESI+EDX*4],EAX
   186 00000198 42                              	INC	EDX
   187 00000199 39 CA                           	CMP	EDX,ECX
   188 0000019B 7C F3                           	JL	L59
   189 0000019D                                 L62:
   190 0000019D 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   191 000001A0 5B                              	POP	EBX
   192 000001A1 5E                              	POP	ESI
   193 000001A2 5F                              	POP	EDI
   194 000001A3 5D                              	POP	EBP
   195 000001A4 C3                              	RET
   196 000001A5                                 	GLOBAL	_task_switchsub
   197 000001A5                                 _task_switchsub:
   198 000001A5 55                              	PUSH	EBP
   199 000001A6 31 C9                           	XOR	ECX,ECX
   200 000001A8 89 E5                           	MOV	EBP,ESP
   201 000001AA A1 [00000000]                   	MOV	EAX,DWORD [_taskctl]
   202 000001AF 31 D2                           	XOR	EDX,EDX
   203 000001B1                                 L69:
   204 000001B1 83 7C 10 10 00                  	CMP	DWORD [16+EAX+EDX*1],0
   205 000001B6 7F 0C                           	JG	L65
   206 000001B8 41                              	INC	ECX
   207 000001B9 81 C2 00000198                  	ADD	EDX,408
   208 000001BF 83 F9 09                        	CMP	ECX,9
   209 000001C2 7E ED                           	JLE	L69
   210 000001C4                                 L65:
   211 000001C4 89 08                           	MOV	DWORD [EAX],ECX
   212 000001C6 C6 40 04 00                     	MOV	BYTE [4+EAX],0
   213 000001CA 5D                              	POP	EBP
   214 000001CB C3                              	RET
   215 000001CC                                 	GLOBAL	_task_idle
   216 000001CC                                 _task_idle:
   217 000001CC 55                              	PUSH	EBP
   218 000001CD 89 E5                           	MOV	EBP,ESP
   219 000001CF                                 L72:
   220 000001CF E8 [00000000]                   	CALL	_io_hlt
   221 000001D4 EB F9                           	JMP	L72
   222 000001D6                                 	GLOBAL	_task_init
   223 000001D6                                 _task_init:
   224 000001D6 55                              	PUSH	EBP
   225 000001D7 89 E5                           	MOV	EBP,ESP
   226 000001D9 57                              	PUSH	EDI
   227 000001DA 56                              	PUSH	ESI
   228 000001DB 31 FF                           	XOR	EDI,EDI
   229 000001DD 53                              	PUSH	EBX
   230 000001DE 31 F6                           	XOR	ESI,ESI
   231 000001E0 53                              	PUSH	EBX
   232 000001E1 BB 000003E7                     	MOV	EBX,999
   233 000001E6 A1 0026F000                     	MOV	EAX,DWORD [2551808]
   234 000001EB 68 00046560                     	PUSH	288096
   235 000001F0 FF 75 08                        	PUSH	DWORD [8+EBP]
   236 000001F3 89 45 F0                        	MOV	DWORD [-16+EBP],EAX
   237 000001F6 E8 [00000000]                   	CALL	_memman_alloc_4k
   238 000001FB 6A 00                           	PUSH	0
   239 000001FD A3 [00000000]                   	MOV	DWORD [_taskctl],EAX
   240 00000202 6A 47                           	PUSH	71
   241 00000204 6A 07                           	PUSH	7
   242 00000206 50                              	PUSH	EAX
   243 00000207 68 00268000                     	PUSH	2523136
   244 0000020C FF 75 F0                        	PUSH	DWORD [-16+EBP]
   245 0000020F E8 [00000000]                   	CALL	_memmam_link_page_32_m
   246 00000214 83 C4 20                        	ADD	ESP,32
   247 00000217                                 L80:
   248 00000217 89 FA                           	MOV	EDX,EDI
   249 00000219 8D 46 18                        	LEA	EAX,DWORD [24+ESI]
   250 0000021C 03 15 [00000000]                	ADD	EDX,DWORD [_taskctl]
   251 00000222 89 82 00001000                  	MOV	DWORD [4096+EDX],EAX
   252 00000228 8D 86 00001F58                  	LEA	EAX,DWORD [8024+ESI]
   253 0000022E 89 82 0000108C                  	MOV	DWORD [4236+EDX],EAX
   254 00000234 8D 86 00270018                  	LEA	EAX,DWORD [2555928+ESI]
   255 0000023A C7 82 00001004 00000000         	MOV	DWORD [4100+EDX],0
   256 00000244 68 00000089                     	PUSH	137
   257 00000249 81 C2 0000102C                  	ADD	EDX,4140
   258 0000024F 52                              	PUSH	EDX
   259 00000250 6A 67                           	PUSH	103
   260 00000252 50                              	PUSH	EAX
   261 00000253 E8 [00000000]                   	CALL	_set_segmdesc
   262 00000258 A1 [00000000]                   	MOV	EAX,DWORD [_taskctl]
   263 0000025D 01 F8                           	ADD	EAX,EDI
   264 0000025F 68 00000082                     	PUSH	130
   265 00000264 05 00001094                     	ADD	EAX,4244
   266 00000269 81 C7 0000011C                  	ADD	EDI,284
   267 0000026F 50                              	PUSH	EAX
   268 00000270 8D 86 00271F58                  	LEA	EAX,DWORD [2563928+ESI]
   269 00000276 6A 1F                           	PUSH	31
   270 00000278 83 C6 08                        	ADD	ESI,8
   271 0000027B 50                              	PUSH	EAX
   272 0000027C E8 [00000000]                   	CALL	_set_segmdesc
   273 00000281 83 C4 20                        	ADD	ESP,32
   274 00000284 4B                              	DEC	EBX
   275 00000285 79 90                           	JNS	L80
   276 00000287 8B 15 [00000000]                	MOV	EDX,DWORD [_taskctl]
   277 0000028D 31 C9                           	XOR	ECX,ECX
   278 0000028F BB 00000009                     	MOV	EBX,9
   279 00000294                                 L85:
   280 00000294 8D 04 0A                        	LEA	EAX,DWORD [EDX+ECX*1]
   281 00000297 81 C1 00000198                  	ADD	ECX,408
   282 0000029D 4B                              	DEC	EBX
   283 0000029E C7 40 10 00000000               	MOV	DWORD [16+EAX],0
   284 000002A5 C7 40 14 00000000               	MOV	DWORD [20+EAX],0
   285 000002AC 79 E6                           	JNS	L85
   286 000002AE C7 42 08 00000000               	MOV	DWORD [8+EDX],0
   287 000002B5 C7 42 0C 00000000               	MOV	DWORD [12+EDX],0
   288 000002BC C7 05 [00000008] 00000000       	MOV	DWORD [_zero_task_lock],0
   289 000002C6 E8 000000F6                     	CALL	_task_alloc
   290 000002CB 89 C6                           	MOV	ESI,EAX
   291 000002CD C7 40 48 00268000               	MOV	DWORD [72+EAX],2523136
   292 000002D4 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   293 000002D7 89 86 00000104                  	MOV	DWORD [260+ESI],EAX
   294 000002DD C7 46 04 00000002               	MOV	DWORD [4+ESI],2
   295 000002E4 C7 46 0C 00000002               	MOV	DWORD [12+ESI],2
   296 000002EB C7 46 08 00000000               	MOV	DWORD [8+ESI],0
   297 000002F2 56                              	PUSH	ESI
   298 000002F3 E8 FFFFFDFB                     	CALL	_task_add
   299 000002F8 E8 FFFFFEA8                     	CALL	_task_switchsub
   300 000002FD FF 36                           	PUSH	DWORD [ESI]
   301 000002FF E8 [00000000]                   	CALL	_load_tr
   302 00000304 E8 [00000000]                   	CALL	_timer_alloc
   303 00000309 FF 76 0C                        	PUSH	DWORD [12+ESI]
   304 0000030C 50                              	PUSH	EAX
   305 0000030D A3 [00000004]                   	MOV	DWORD [_task_timer],EAX
   306 00000312 E8 [00000000]                   	CALL	_timer_settime
   307 00000317 E8 000000A5                     	CALL	_task_alloc
   308 0000031C 68 00010000                     	PUSH	65536
   309 00000321 FF 75 08                        	PUSH	DWORD [8+EBP]
   310 00000324 89 C3                           	MOV	EBX,EAX
   311 00000326 E8 [00000000]                   	CALL	_memman_alloc_4k
   312 0000032B 05 00010000                     	ADD	EAX,65536
   313 00000330 89 43 64                        	MOV	DWORD [100+EBX],EAX
   314 00000333 6A 00                           	PUSH	0
   315 00000335 6A 10                           	PUSH	16
   316 00000337 6A 07                           	PUSH	7
   317 00000339 8B 43 64                        	MOV	EAX,DWORD [100+EBX]
   318 0000033C 2D 00010000                     	SUB	EAX,65536
   319 00000341 50                              	PUSH	EAX
   320 00000342 68 00268000                     	PUSH	2523136
   321 00000347 FF 75 F0                        	PUSH	DWORD [-16+EBP]
   322 0000034A E8 [00000000]                   	CALL	_memmam_link_page_32_m
   323 0000034F 83 C4 30                        	ADD	ESP,48
   324 00000352 C7 43 4C [000001CC]             	MOV	DWORD [76+EBX],_task_idle
   325 00000359 C7 43 74 00000008               	MOV	DWORD [116+EBX],8
   326 00000360 C7 43 78 00000010               	MOV	DWORD [120+EBX],16
   327 00000367 C7 43 7C 00000008               	MOV	DWORD [124+EBX],8
   328 0000036E C7 83 00000080 00000008         	MOV	DWORD [128+EBX],8
   329 00000378 C7 83 00000084 00000008         	MOV	DWORD [132+EBX],8
   330 00000382 C7 83 00000088 00000008         	MOV	DWORD [136+EBX],8
   331 0000038C C7 43 48 00268000               	MOV	DWORD [72+EBX],2523136
   332 00000393 C7 83 000000FC 00000000         	MOV	DWORD [252+EBX],0
   333 0000039D C7 83 000000F8 00000000         	MOV	DWORD [248+EBX],0
   334 000003A7 89 9B 000000F4                  	MOV	DWORD [244+EBX],EBX
   335 000003AD 6A 01                           	PUSH	1
   336 000003AF 6A 09                           	PUSH	9
   337 000003B1 53                              	PUSH	EBX
   338 000003B2 E8 00000118                     	CALL	_task_run
   339 000003B7 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   340 000003BA 5B                              	POP	EBX
   341 000003BB 89 F0                           	MOV	EAX,ESI
   342 000003BD 5E                              	POP	ESI
   343 000003BE 5F                              	POP	EDI
   344 000003BF 5D                              	POP	EBP
   345 000003C0 C3                              	RET
   346 000003C1                                 	GLOBAL	_task_alloc
   347 000003C1                                 _task_alloc:
   348 000003C1 55                              	PUSH	EBP
   349 000003C2 31 D2                           	XOR	EDX,EDX
   350 000003C4 89 E5                           	MOV	EBP,ESP
   351 000003C6 53                              	PUSH	EBX
   352 000003C7 31 DB                           	XOR	EBX,EBX
   353 000003C9                                 L96:
   354 000003C9 8B 0D [00000000]                	MOV	ECX,DWORD [_taskctl]
   355 000003CF 8D 04 11                        	LEA	EAX,DWORD [ECX+EDX*1]
   356 000003D2 83 B8 00001004 00               	CMP	DWORD [4100+EAX],0
   357 000003D9 74 14                           	JE	L99
   358 000003DB 43                              	INC	EBX
   359 000003DC 81 C2 0000011C                  	ADD	EDX,284
   360 000003E2 81 FB 000003E7                  	CMP	EBX,999
   361 000003E8 7E DF                           	JLE	L96
   362 000003EA 31 C0                           	XOR	EAX,EAX
   363 000003EC                                 L90:
   364 000003EC 5B                              	POP	EBX
   365 000003ED 5D                              	POP	EBP
   366 000003EE C3                              	RET
   367 000003EF                                 L99:
   368 000003EF 05 00001000                     	ADD	EAX,4096
   369 000003F4 C7 40 04 00000001               	MOV	DWORD [4+EAX],1
   370 000003FB C7 40 50 00000202               	MOV	DWORD [80+EAX],514
   371 00000402 C7 40 54 00000000               	MOV	DWORD [84+EAX],0
   372 00000409 C7 40 58 00000000               	MOV	DWORD [88+EAX],0
   373 00000410 C7 40 5C 00000000               	MOV	DWORD [92+EAX],0
   374 00000417 C7 40 60 00000000               	MOV	DWORD [96+EAX],0
   375 0000041E C7 40 68 00000000               	MOV	DWORD [104+EAX],0
   376 00000425 C7 40 6C 00000000               	MOV	DWORD [108+EAX],0
   377 0000042C C7 40 70 00000000               	MOV	DWORD [112+EAX],0
   378 00000433 C7 40 74 00000000               	MOV	DWORD [116+EAX],0
   379 0000043A C7 80 00000080 00000000         	MOV	DWORD [128+EAX],0
   380 00000444 C7 80 00000084 00000000         	MOV	DWORD [132+EAX],0
   381 0000044E C7 80 00000088 00000000         	MOV	DWORD [136+EAX],0
   382 00000458 C7 80 00000090 40000000         	MOV	DWORD [144+EAX],1073741824
   383 00000462 C7 40 34 00000000               	MOV	DWORD [52+EAX],0
   384 00000469 C7 40 48 00000000               	MOV	DWORD [72+EAX],0
   385 00000470 C7 80 00000100 00000000         	MOV	DWORD [256+EAX],0
   386 0000047A 8B 51 08                        	MOV	EDX,DWORD [8+ECX]
   387 0000047D 89 80 000000F4                  	MOV	DWORD [244+EAX],EAX
   388 00000483 89 90 00000114                  	MOV	DWORD [276+EAX],EDX
   389 00000489 8B 51 0C                        	MOV	EDX,DWORD [12+ECX]
   390 0000048C FF 41 08                        	INC	DWORD [8+ECX]
   391 0000048F 89 90 00000118                  	MOV	DWORD [280+EAX],EDX
   392 00000495 FF 41 0C                        	INC	DWORD [12+ECX]
   393 00000498 C7 80 000000FC 00000000         	MOV	DWORD [252+EAX],0
   394 000004A2 C7 80 000000F8 00000000         	MOV	DWORD [248+EAX],0
   395 000004AC C7 80 00000108 00000000         	MOV	DWORD [264+EAX],0
   396 000004B6 C7 80 0000010C 00000000         	MOV	DWORD [268+EAX],0
   397 000004C0 C7 80 00000110 00000000         	MOV	DWORD [272+EAX],0
   398 000004CA E9 FFFFFF1D                     	JMP	L90
   399 000004CF                                 	GLOBAL	_task_run
   400 000004CF                                 _task_run:
   401 000004CF 55                              	PUSH	EBP
   402 000004D0 89 E5                           	MOV	EBP,ESP
   403 000004D2 56                              	PUSH	ESI
   404 000004D3 53                              	PUSH	EBX
   405 000004D4 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   406 000004D7 8B 75 0C                        	MOV	ESI,DWORD [12+EBP]
   407 000004DA 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   408 000004DD 83 BB 00000114 00               	CMP	DWORD [276+EBX],0
   409 000004E4 75 13                           	JNE	L101
   410 000004E6 83 BB 00000118 00               	CMP	DWORD [280+EBX],0
   411 000004ED 75 0A                           	JNE	L101
   412 000004EF C7 05 [00000008] 00000000       	MOV	DWORD [_zero_task_lock],0
   413 000004F9                                 L101:
   414 000004F9 85 F6                           	TEST	ESI,ESI
   415 000004FB 78 3B                           	JS	L108
   416 000004FD                                 L104:
   417 000004FD 85 C0                           	TEST	EAX,EAX
   418 000004FF 7E 03                           	JLE	L105
   419 00000501 89 43 0C                        	MOV	DWORD [12+EBX],EAX
   420 00000504                                 L105:
   421 00000504 83 7B 04 02                     	CMP	DWORD [4+EBX],2
   422 00000508 74 20                           	JE	L109
   423 0000050A                                 L106:
   424 0000050A 83 7B 04 02                     	CMP	DWORD [4+EBX],2
   425 0000050E 74 0A                           	JE	L107
   426 00000510 89 73 08                        	MOV	DWORD [8+EBX],ESI
   427 00000513 53                              	PUSH	EBX
   428 00000514 E8 FFFFFBDA                     	CALL	_task_add
   429 00000519 5E                              	POP	ESI
   430 0000051A                                 L107:
   431 0000051A A1 [00000000]                   	MOV	EAX,DWORD [_taskctl]
   432 0000051F C6 40 04 01                     	MOV	BYTE [4+EAX],1
   433 00000523 8D 65 F8                        	LEA	ESP,DWORD [-8+EBP]
   434 00000526 5B                              	POP	EBX
   435 00000527 5E                              	POP	ESI
   436 00000528 5D                              	POP	EBP
   437 00000529 C3                              	RET
   438 0000052A                                 L109:
   439 0000052A 39 73 08                        	CMP	DWORD [8+EBX],ESI
   440 0000052D 74 DB                           	JE	L106
   441 0000052F 53                              	PUSH	EBX
   442 00000530 E8 FFFFFBE7                     	CALL	_task_remove
   443 00000535 58                              	POP	EAX
   444 00000536 EB D2                           	JMP	L106
   445 00000538                                 L108:
   446 00000538 8B 73 08                        	MOV	ESI,DWORD [8+EBX]
   447 0000053B EB C0                           	JMP	L104
   448 0000053D                                 	GLOBAL	_task_sleep
   449 0000053D                                 _task_sleep:
   450 0000053D 55                              	PUSH	EBP
   451 0000053E 89 E5                           	MOV	EBP,ESP
   452 00000540 56                              	PUSH	ESI
   453 00000541 53                              	PUSH	EBX
   454 00000542 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   455 00000545 83 7E 04 02                     	CMP	DWORD [4+ESI],2
   456 00000549 74 07                           	JE	L113
   457 0000054B                                 L110:
   458 0000054B 8D 65 F8                        	LEA	ESP,DWORD [-8+EBP]
   459 0000054E 5B                              	POP	EBX
   460 0000054F 5E                              	POP	ESI
   461 00000550 5D                              	POP	EBP
   462 00000551 C3                              	RET
   463 00000552                                 L113:
   464 00000552 E8 FFFFFAA9                     	CALL	_task_now
   465 00000557 56                              	PUSH	ESI
   466 00000558 89 C3                           	MOV	EBX,EAX
   467 0000055A E8 FFFFFBBD                     	CALL	_task_remove
   468 0000055F 59                              	POP	ECX
   469 00000560 39 DE                           	CMP	ESI,EBX
   470 00000562 75 E7                           	JNE	L110
   471 00000564 E8 FFFFFC3C                     	CALL	_task_switchsub
   472 00000569 E8 FFFFFA92                     	CALL	_task_now
   473 0000056E FF 30                           	PUSH	DWORD [EAX]
   474 00000570 6A 00                           	PUSH	0
   475 00000572 E8 [00000000]                   	CALL	_farjmp
   476 00000577 58                              	POP	EAX
   477 00000578 5A                              	POP	EDX
   478 00000579 EB D0                           	JMP	L110
   479 0000057B                                 	GLOBAL	_task_switch
   480 0000057B                                 _task_switch:
   481 0000057B 55                              	PUSH	EBP
   482 0000057C 89 E5                           	MOV	EBP,ESP
   483 0000057E 56                              	PUSH	ESI
   484 0000057F 53                              	PUSH	EBX
   485 00000580 8B 1D [00000000]                	MOV	EBX,DWORD [_taskctl]
   486 00000586 8B 13                           	MOV	EDX,DWORD [EBX]
   487 00000588 69 D2 00000198                  	IMUL	EDX,EDX,408
   488 0000058E 8D 14 1A                        	LEA	EDX,DWORD [EDX+EBX*1]
   489 00000591 8D 4A 10                        	LEA	ECX,DWORD [16+EDX]
   490 00000594 8B 41 04                        	MOV	EAX,DWORD [4+ECX]
   491 00000597 8B 74 81 08                     	MOV	ESI,DWORD [8+ECX+EAX*4]
   492 0000059B 40                              	INC	EAX
   493 0000059C 89 41 04                        	MOV	DWORD [4+ECX],EAX
   494 0000059F 3B 42 10                        	CMP	EAX,DWORD [16+EDX]
   495 000005A2 74 4C                           	JE	L118
   496 000005A4                                 L115:
   497 000005A4 80 7B 04 00                     	CMP	BYTE [4+EBX],0
   498 000005A8 75 2D                           	JNE	L119
   499 000005AA                                 L116:
   500 000005AA 8B 41 04                        	MOV	EAX,DWORD [4+ECX]
   501 000005AD 8B 5C 81 08                     	MOV	EBX,DWORD [8+ECX+EAX*4]
   502 000005B1 FF 73 0C                        	PUSH	DWORD [12+EBX]
   503 000005B4 FF 35 [00000004]                	PUSH	DWORD [_task_timer]
   504 000005BA E8 [00000000]                   	CALL	_timer_settime
   505 000005BF 39 F3                           	CMP	EBX,ESI
   506 000005C1 58                              	POP	EAX
   507 000005C2 5A                              	POP	EDX
   508 000005C3 74 0B                           	JE	L114
   509 000005C5 FF 33                           	PUSH	DWORD [EBX]
   510 000005C7 6A 00                           	PUSH	0
   511 000005C9 E8 [00000000]                   	CALL	_farjmp
   512 000005CE 5B                              	POP	EBX
   513 000005CF 5E                              	POP	ESI
   514 000005D0                                 L114:
   515 000005D0 8D 65 F8                        	LEA	ESP,DWORD [-8+EBP]
   516 000005D3 5B                              	POP	EBX
   517 000005D4 5E                              	POP	ESI
   518 000005D5 5D                              	POP	EBP
   519 000005D6 C3                              	RET
   520 000005D7                                 L119:
   521 000005D7 E8 FFFFFBC9                     	CALL	_task_switchsub
   522 000005DC 8B 15 [00000000]                	MOV	EDX,DWORD [_taskctl]
   523 000005E2 8B 02                           	MOV	EAX,DWORD [EDX]
   524 000005E4 69 C0 00000198                  	IMUL	EAX,EAX,408
   525 000005EA 8D 4C 10 10                     	LEA	ECX,DWORD [16+EAX+EDX*1]
   526 000005EE EB BA                           	JMP	L116
   527 000005F0                                 L118:
   528 000005F0 C7 41 04 00000000               	MOV	DWORD [4+ECX],0
   529 000005F7 EB AB                           	JMP	L115
   530 000005F9                                 	GLOBAL	_task_lanch
   531 000005F9                                 _task_lanch:
   532 000005F9 55                              	PUSH	EBP
   533 000005FA 89 E5                           	MOV	EBP,ESP
   534 000005FC 5D                              	POP	EBP
   535 000005FD C3                              	RET
   536 000005FE                                 	GLOBAL	_task_get_index
   537 000005FE                                 _task_get_index:
   538 000005FE 55                              	PUSH	EBP
   539 000005FF 89 E5                           	MOV	EBP,ESP
   540 00000601 5D                              	POP	EBP
   541 00000602 C3                              	RET
   542 00000603                                 	GLOBAL	_taskctl
   543                                          [SECTION .data]
   544 00000000                                 	ALIGNB	4
   545 00000000                                 _taskctl:
   546 00000000 00 00 00 00                     	RESB	4
   547 00000004                                 	GLOBAL	_task_timer
   548                                          [SECTION .data]
   549 00000004                                 	ALIGNB	4
   550 00000004                                 _task_timer:
   551 00000004 00 00 00 00                     	RESB	4
   552 00000008                                 	GLOBAL	_zero_task_lock
   553                                          [SECTION .data]
   554 00000008                                 	ALIGNB	4
   555 00000008                                 _zero_task_lock:
   556 00000008 00 00 00 00                     	RESB	4
