     1 00000000                                 [FORMAT "WCOFF"]
     2 00000000                                 [INSTRSET "i486p"]
     3 00000000                                 [OPTIMIZE 1]
     4 00000000                                 [OPTION 1]
     5 00000000                                 [BITS 32]
     6 00000000                                 	EXTERN	_io_hlt
     7 00000000                                 	EXTERN	_memman_alloc_4k
     8 00000000                                 	EXTERN	_memmam_link_page_32_m
     9 00000000                                 	EXTERN	_set_segmdesc
    10 00000000                                 	EXTERN	_load_tr
    11 00000000                                 	EXTERN	_timer_alloc
    12 00000000                                 	EXTERN	_timer_settime
    13 00000000                                 	EXTERN	_get_this
    14 00000000                                 	EXTERN	_farjmp
    15 00000000                                 	EXTERN	_fifo32_put
    16 00000000                                 [FILE "mtask.c"]
    17 00000000                                 	GLOBAL	_taskctl
    18                                          [SECTION .data]
    19 00000000                                 	ALIGNB	4
    20 00000000                                 _taskctl:
    21 00000000 00000000                        	DD	0
    22 00000004                                 	GLOBAL	_zero_task_lock
    23 00000004                                 	ALIGNB	4
    24 00000004                                 _zero_task_lock:
    25 00000004 00000000                        	DD	0
    26 00000008                                 	GLOBAL	_task_ready
    27 00000008                                 	ALIGNB	4
    28 00000008                                 _task_ready:
    29 00000008 00000000                        	DD	0
    30                                          [SECTION .text]
    31 00000000                                 	GLOBAL	_task_ctl_now
    32 00000000                                 _task_ctl_now:
    33 00000000 55                              	PUSH	EBP
    34 00000001 A1 [00000000]                   	MOV	EAX,DWORD [_taskctl]
    35 00000006 89 E5                           	MOV	EBP,ESP
    36 00000008 5D                              	POP	EBP
    37 00000009 C3                              	RET
    38 0000000A                                 	GLOBAL	_task_now
    39 0000000A                                 _task_now:
    40 0000000A 55                              	PUSH	EBP
    41 0000000B 89 E5                           	MOV	EBP,ESP
    42 0000000D 83 3D [00000008] 00             	CMP	DWORD [_task_ready],0
    43 00000014 74 1A                           	JE	L3
    44 00000016 A1 [00000000]                   	MOV	EAX,DWORD [_taskctl]
    45 0000001B 8B 10                           	MOV	EDX,DWORD [EAX]
    46 0000001D 69 D2 00000198                  	IMUL	EDX,EDX,408
    47 00000023 8D 44 02 0D                     	LEA	EAX,DWORD [13+EDX+EAX*1]
    48 00000027 8B 50 04                        	MOV	EDX,DWORD [4+EAX]
    49 0000002A 8B 44 90 08                     	MOV	EAX,DWORD [8+EAX+EDX*4]
    50 0000002E                                 L2:
    51 0000002E 5D                              	POP	EBP
    52 0000002F C3                              	RET
    53 00000030                                 L3:
    54 00000030 31 C0                           	XOR	EAX,EAX
    55 00000032 EB FA                           	JMP	L2
    56 00000034                                 	GLOBAL	_add_child_task
    57 00000034                                 _add_child_task:
    58 00000034 55                              	PUSH	EBP
    59 00000035 89 E5                           	MOV	EBP,ESP
    60 00000037 53                              	PUSH	EBX
    61 00000038 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
    62 0000003B 8B 4D 0C                        	MOV	ECX,DWORD [12+EBP]
    63 0000003E 8B 83 0000010A                  	MOV	EAX,DWORD [266+EBX]
    64 00000044 85 C0                           	TEST	EAX,EAX
    65 00000046 75 0F                           	JNE	L6
    66 00000048 89 8B 0000010A                  	MOV	DWORD [266+EBX],ECX
    67 0000004E                                 L15:
    68 0000004E 89 99 0000010E                  	MOV	DWORD [270+ECX],EBX
    69 00000054 5B                              	POP	EBX
    70 00000055 5D                              	POP	EBP
    71 00000056 C3                              	RET
    72 00000057                                 L6:
    73 00000057 89 C2                           	MOV	EDX,EAX
    74 00000059 39 80 00000106                  	CMP	DWORD [262+EAX],EAX
    75 0000005F 74 0E                           	JE	L14
    76 00000061                                 L12:
    77 00000061 8B 92 00000106                  	MOV	EDX,DWORD [262+EDX]
    78 00000067 39 82 00000106                  	CMP	DWORD [262+EDX],EAX
    79 0000006D 75 F2                           	JNE	L12
    80 0000006F                                 L14:
    81 0000006F 8B 82 00000106                  	MOV	EAX,DWORD [262+EDX]
    82 00000075 89 81 00000106                  	MOV	DWORD [262+ECX],EAX
    83 0000007B 89 8A 00000106                  	MOV	DWORD [262+EDX],ECX
    84 00000081 EB CB                           	JMP	L15
    85 00000083                                 	GLOBAL	_find_child_task
    86 00000083                                 _find_child_task:
    87 00000083 55                              	PUSH	EBP
    88 00000084 89 E5                           	MOV	EBP,ESP
    89 00000086 53                              	PUSH	EBX
    90 00000087 31 DB                           	XOR	EBX,EBX
    91 00000089 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
    92 0000008C 8B 80 0000010A                  	MOV	EAX,DWORD [266+EAX]
    93 00000092 85 C0                           	TEST	EAX,EAX
    94 00000094 74 1C                           	JE	L16
    95 00000096                                 L26:
    96 00000096 89 C2                           	MOV	EDX,EAX
    97 00000098 89 C1                           	MOV	ECX,EAX
    98 0000009A                                 L19:
    99 0000009A 8B 82 0000010A                  	MOV	EAX,DWORD [266+EDX]
   100 000000A0 85 C0                           	TEST	EAX,EAX
   101 000000A2 75 F2                           	JNE	L26
   102 000000A4 8B 82 00000106                  	MOV	EAX,DWORD [262+EDX]
   103 000000AA 89 D3                           	MOV	EBX,EDX
   104 000000AC 39 C8                           	CMP	EAX,ECX
   105 000000AE 89 C2                           	MOV	EDX,EAX
   106 000000B0 75 E8                           	JNE	L19
   107 000000B2                                 L16:
   108 000000B2 89 D8                           	MOV	EAX,EBX
   109 000000B4 5B                              	POP	EBX
   110 000000B5 5D                              	POP	EBP
   111 000000B6 C3                              	RET
   112 000000B7                                 	GLOBAL	_unlink_task
   113 000000B7                                 _unlink_task:
   114 000000B7 55                              	PUSH	EBP
   115 000000B8 89 E5                           	MOV	EBP,ESP
   116 000000BA 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   117 000000BD 83 B8 0000010A 00               	CMP	DWORD [266+EAX],0
   118 000000C4 75 2A                           	JNE	L27
   119 000000C6 89 C2                           	MOV	EDX,EAX
   120 000000C8 39 80 00000106                  	CMP	DWORD [262+EAX],EAX
   121 000000CE 74 0E                           	JE	L38
   122 000000D0                                 L34:
   123 000000D0 8B 92 00000106                  	MOV	EDX,DWORD [262+EDX]
   124 000000D6 39 82 00000106                  	CMP	DWORD [262+EDX],EAX
   125 000000DC 75 F2                           	JNE	L34
   126 000000DE                                 L38:
   127 000000DE 39 C2                           	CMP	EDX,EAX
   128 000000E0 74 10                           	JE	L40
   129 000000E2 8B 80 00000106                  	MOV	EAX,DWORD [262+EAX]
   130 000000E8 89 82 00000106                  	MOV	DWORD [262+EDX],EAX
   131 000000EE                                 L39:
   132 000000EE 31 C0                           	XOR	EAX,EAX
   133 000000F0                                 L27:
   134 000000F0 5D                              	POP	EBP
   135 000000F1 C3                              	RET
   136 000000F2                                 L40:
   137 000000F2 8B 92 0000010E                  	MOV	EDX,DWORD [270+EDX]
   138 000000F8 C7 82 0000010A 00000000         	MOV	DWORD [266+EDX],0
   139 00000102 EB EA                           	JMP	L39
   140 00000104                                 	GLOBAL	_task_add
   141 00000104                                 _task_add:
   142 00000104 55                              	PUSH	EBP
   143 00000105 89 E5                           	MOV	EBP,ESP
   144 00000107 8B 4D 08                        	MOV	ECX,DWORD [8+EBP]
   145 0000010A 8B 51 08                        	MOV	EDX,DWORD [8+ECX]
   146 0000010D 69 D2 00000198                  	IMUL	EDX,EDX,408
   147 00000113 03 15 [00000000]                	ADD	EDX,DWORD [_taskctl]
   148 00000119 8B 42 0D                        	MOV	EAX,DWORD [13+EDX]
   149 0000011C 89 4C 82 15                     	MOV	DWORD [21+EDX+EAX*4],ECX
   150 00000120 40                              	INC	EAX
   151 00000121 89 42 0D                        	MOV	DWORD [13+EDX],EAX
   152 00000124 C7 41 04 00000002               	MOV	DWORD [4+ECX],2
   153 0000012B 5D                              	POP	EBP
   154 0000012C C3                              	RET
   155 0000012D                                 	GLOBAL	_task_remove
   156 0000012D                                 _task_remove:
   157 0000012D                                 L48:
   158 0000012D                                 L43:
   159 0000012D 55                              	PUSH	EBP
   160 0000012E 89 E5                           	MOV	EBP,ESP
   161 00000130 53                              	PUSH	EBX
   162 00000131 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   163 00000134 8B 43 08                        	MOV	EAX,DWORD [8+EBX]
   164 00000137 69 C0 00000198                  	IMUL	EAX,EAX,408
   165 0000013D 03 05 [00000000]                	ADD	EAX,DWORD [_taskctl]
   166 00000143 8D 50 0D                        	LEA	EDX,DWORD [13+EAX]
   167 00000146 31 C9                           	XOR	ECX,ECX
   168 00000148 8B 40 0D                        	MOV	EAX,DWORD [13+EAX]
   169 0000014B 39 C1                           	CMP	ECX,EAX
   170 0000014D 7D 0B                           	JGE	L51
   171 0000014F                                 L55:
   172 0000014F 39 5C 8A 08                     	CMP	DWORD [8+EDX+ECX*4],EBX
   173 00000153 74 05                           	JE	L51
   174 00000155 41                              	INC	ECX
   175 00000156 39 C1                           	CMP	ECX,EAX
   176 00000158 7C F5                           	JL	L55
   177 0000015A                                 L51:
   178 0000015A 48                              	DEC	EAX
   179 0000015B 89 02                           	MOV	DWORD [EDX],EAX
   180 0000015D 8B 42 04                        	MOV	EAX,DWORD [4+EDX]
   181 00000160 39 C1                           	CMP	ECX,EAX
   182 00000162 7D 04                           	JGE	L56
   183 00000164 48                              	DEC	EAX
   184 00000165 89 42 04                        	MOV	DWORD [4+EDX],EAX
   185 00000168                                 L56:
   186 00000168 8B 02                           	MOV	EAX,DWORD [EDX]
   187 0000016A 39 42 04                        	CMP	DWORD [4+EDX],EAX
   188 0000016D 7C 07                           	JL	L57
   189 0000016F C7 42 04 00000000               	MOV	DWORD [4+EDX],0
   190 00000176                                 L57:
   191 00000176 C7 43 04 00000001               	MOV	DWORD [4+EBX],1
   192 0000017D 8B 1A                           	MOV	EBX,DWORD [EDX]
   193 0000017F 39 D9                           	CMP	ECX,EBX
   194 00000181 7D 0D                           	JGE	L65
   195 00000183                                 L62:
   196 00000183 8B 44 8A 0C                     	MOV	EAX,DWORD [12+EDX+ECX*4]
   197 00000187 89 44 8A 08                     	MOV	DWORD [8+EDX+ECX*4],EAX
   198 0000018B 41                              	INC	ECX
   199 0000018C 39 D9                           	CMP	ECX,EBX
   200 0000018E 7C F3                           	JL	L62
   201 00000190                                 L65:
   202 00000190 5B                              	POP	EBX
   203 00000191 5D                              	POP	EBP
   204 00000192 C3                              	RET
   205 00000193                                 	GLOBAL	_task_switchsub
   206 00000193                                 _task_switchsub:
   207 00000193 55                              	PUSH	EBP
   208 00000194 31 C9                           	XOR	ECX,ECX
   209 00000196 89 E5                           	MOV	EBP,ESP
   210 00000198 A1 [00000000]                   	MOV	EAX,DWORD [_taskctl]
   211 0000019D 31 D2                           	XOR	EDX,EDX
   212 0000019F                                 L72:
   213 0000019F 83 7C 10 0D 00                  	CMP	DWORD [13+EAX+EDX*1],0
   214 000001A4 7F 0C                           	JG	L68
   215 000001A6 41                              	INC	ECX
   216 000001A7 81 C2 00000198                  	ADD	EDX,408
   217 000001AD 83 F9 09                        	CMP	ECX,9
   218 000001B0 7E ED                           	JLE	L72
   219 000001B2                                 L68:
   220 000001B2 89 08                           	MOV	DWORD [EAX],ECX
   221 000001B4 C6 40 04 00                     	MOV	BYTE [4+EAX],0
   222 000001B8 5D                              	POP	EBP
   223 000001B9 C3                              	RET
   224 000001BA                                 	GLOBAL	_task_idle
   225 000001BA                                 _task_idle:
   226 000001BA 55                              	PUSH	EBP
   227 000001BB 89 E5                           	MOV	EBP,ESP
   228 000001BD                                 L75:
   229 000001BD E8 [00000000]                   	CALL	_io_hlt
   230 000001C2 EB F9                           	JMP	L75
   231                                          [SECTION .data]
   232 0000000C                                 LC0:
   233 0000000C 4E 4F 4E 41 4D 45 00            	DB	"NONAME",0x00
   234 00000013                                 LC1:
   235 00000013 6D 61 69 6E 6C 6F 6F 70 00      	DB	"mainloop",0x00
   236 0000001C                                 LC2:
   237 0000001C 69 64 6C 65 00                  	DB	"idle",0x00
   238                                          [SECTION .text]
   239 000001C4                                 	GLOBAL	_task_init
   240 000001C4                                 _task_init:
   241 000001C4 55                              	PUSH	EBP
   242 000001C5 89 E5                           	MOV	EBP,ESP
   243 000001C7 57                              	PUSH	EDI
   244 000001C8 56                              	PUSH	ESI
   245 000001C9 31 FF                           	XOR	EDI,EDI
   246 000001CB 53                              	PUSH	EBX
   247 000001CC 31 F6                           	XOR	ESI,ESI
   248 000001CE 50                              	PUSH	EAX
   249 000001CF BB 000003E7                     	MOV	EBX,999
   250 000001D4 A1 0026F000                     	MOV	EAX,DWORD [2551808]
   251 000001D9 68 0004DA8D                     	PUSH	318093
   252 000001DE FF 75 08                        	PUSH	DWORD [8+EBP]
   253 000001E1 89 45 F0                        	MOV	DWORD [-16+EBP],EAX
   254 000001E4 E8 [00000000]                   	CALL	_memman_alloc_4k
   255 000001E9 6A 00                           	PUSH	0
   256 000001EB A3 [00000000]                   	MOV	DWORD [_taskctl],EAX
   257 000001F0 6A 4E                           	PUSH	78
   258 000001F2 6A 07                           	PUSH	7
   259 000001F4 50                              	PUSH	EAX
   260 000001F5 68 00268000                     	PUSH	2523136
   261 000001FA FF 75 F0                        	PUSH	DWORD [-16+EBP]
   262 000001FD E8 [00000000]                   	CALL	_memmam_link_page_32_m
   263 00000202 83 C4 20                        	ADD	ESP,32
   264 00000205                                 L83:
   265 00000205 89 FA                           	MOV	EDX,EDI
   266 00000207 8D 46 18                        	LEA	EAX,DWORD [24+ESI]
   267 0000020A 03 15 [00000000]                	ADD	EDX,DWORD [_taskctl]
   268 00000210 8D 8A 00000FF0                  	LEA	ECX,DWORD [4080+EDX]
   269 00000216 89 41 0D                        	MOV	DWORD [13+ECX],EAX
   270 00000219 8D 86 00001F58                  	LEA	EAX,DWORD [8024+ESI]
   271 0000021F 89 82 0000109D                  	MOV	DWORD [4253+EDX],EAX
   272 00000225 8D 86 00270018                  	LEA	EAX,DWORD [2555928+ESI]
   273 0000022B C7 41 11 00000000               	MOV	DWORD [17+ECX],0
   274 00000232 81 C2 0000103D                  	ADD	EDX,4157
   275 00000238 68 00000089                     	PUSH	137
   276 0000023D 52                              	PUSH	EDX
   277 0000023E 6A 67                           	PUSH	103
   278 00000240 50                              	PUSH	EAX
   279 00000241 E8 [00000000]                   	CALL	_set_segmdesc
   280 00000246 A1 [00000000]                   	MOV	EAX,DWORD [_taskctl]
   281 0000024B 01 F8                           	ADD	EAX,EDI
   282 0000024D 68 00000082                     	PUSH	130
   283 00000252 05 000010A5                     	ADD	EAX,4261
   284 00000257 50                              	PUSH	EAX
   285 00000258 8D 86 00271F58                  	LEA	EAX,DWORD [2563928+ESI]
   286 0000025E 6A 1F                           	PUSH	31
   287 00000260 83 C6 08                        	ADD	ESI,8
   288 00000263 50                              	PUSH	EAX
   289 00000264 E8 [00000000]                   	CALL	_set_segmdesc
   290 00000269 83 C4 20                        	ADD	ESP,32
   291 0000026C A1 [00000000]                   	MOV	EAX,DWORD [_taskctl]
   292 00000271 C7 84 38 00001133 [0000000C]    	MOV	DWORD [4403+EAX+EDI*1],LC0
   293 0000027C 81 C7 0000013A                  	ADD	EDI,314
   294 00000282 4B                              	DEC	EBX
   295 00000283 0F 89 FFFFFF7C                  	JNS	L83
   296 00000289 31 D2                           	XOR	EDX,EDX
   297 0000028B BB 00000009                     	MOV	EBX,9
   298 00000290                                 L88:
   299 00000290 C7 44 10 0D 00000000            	MOV	DWORD [13+EAX+EDX*1],0
   300 00000298 C7 44 10 11 00000000            	MOV	DWORD [17+EAX+EDX*1],0
   301 000002A0 81 C2 00000198                  	ADD	EDX,408
   302 000002A6 4B                              	DEC	EBX
   303 000002A7 79 E7                           	JNS	L88
   304 000002A9 C7 40 05 00000000               	MOV	DWORD [5+EAX],0
   305 000002B0 C7 40 09 00000000               	MOV	DWORD [9+EAX],0
   306 000002B7 C7 05 [00000004] 00000000       	MOV	DWORD [_zero_task_lock],0
   307 000002C1 E8 0000012A                     	CALL	_task_alloc
   308 000002C6 89 C6                           	MOV	ESI,EAX
   309 000002C8 C7 40 5C 00268000               	MOV	DWORD [92+EAX],2523136
   310 000002CF 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   311 000002D2 89 86 00000116                  	MOV	DWORD [278+ESI],EAX
   312 000002D8 C7 46 04 00000002               	MOV	DWORD [4+ESI],2
   313 000002DF C7 46 0C 00000002               	MOV	DWORD [12+ESI],2
   314 000002E6 C7 46 08 00000000               	MOV	DWORD [8+ESI],0
   315 000002ED C7 86 00000136 [00000013]       	MOV	DWORD [310+ESI],LC1
   316 000002F7 56                              	PUSH	ESI
   317 000002F8 E8 FFFFFE07                     	CALL	_task_add
   318 000002FD E8 FFFFFE91                     	CALL	_task_switchsub
   319 00000302 FF 36                           	PUSH	DWORD [ESI]
   320 00000304 E8 [00000000]                   	CALL	_load_tr
   321 00000309 E8 [00000000]                   	CALL	_timer_alloc
   322 0000030E FF 76 0C                        	PUSH	DWORD [12+ESI]
   323 00000311 50                              	PUSH	EAX
   324 00000312 A3 [00000024]                   	MOV	DWORD [_task_timer],EAX
   325 00000317 E8 [00000000]                   	CALL	_timer_settime
   326 0000031C E8 000000CF                     	CALL	_task_alloc
   327 00000321 68 00010000                     	PUSH	65536
   328 00000326 FF 75 08                        	PUSH	DWORD [8+EBP]
   329 00000329 89 C3                           	MOV	EBX,EAX
   330 0000032B E8 [00000000]                   	CALL	_memman_alloc_4k
   331 00000330 05 00010000                     	ADD	EAX,65536
   332 00000335 89 43 78                        	MOV	DWORD [120+EBX],EAX
   333 00000338 6A 00                           	PUSH	0
   334 0000033A 6A 10                           	PUSH	16
   335 0000033C 6A 07                           	PUSH	7
   336 0000033E 8B 43 78                        	MOV	EAX,DWORD [120+EBX]
   337 00000341 2D 00010000                     	SUB	EAX,65536
   338 00000346 50                              	PUSH	EAX
   339 00000347 68 00268000                     	PUSH	2523136
   340 0000034C FF 75 F0                        	PUSH	DWORD [-16+EBP]
   341 0000034F E8 [00000000]                   	CALL	_memmam_link_page_32_m
   342 00000354 83 C4 30                        	ADD	ESP,48
   343 00000357 E8 [00000000]                   	CALL	_get_this
   344 0000035C 89 9B 00000106                  	MOV	DWORD [262+EBX],EBX
   345 00000362 05 [000001BA]                   	ADD	EAX,_task_idle
   346 00000367 89 43 60                        	MOV	DWORD [96+EBX],EAX
   347 0000036A C7 83 00000088 00000008         	MOV	DWORD [136+EBX],8
   348 00000374 C7 83 0000008C 00000010         	MOV	DWORD [140+EBX],16
   349 0000037E C7 83 00000090 00000008         	MOV	DWORD [144+EBX],8
   350 00000388 C7 83 00000094 00000008         	MOV	DWORD [148+EBX],8
   351 00000392 C7 83 00000098 00000008         	MOV	DWORD [152+EBX],8
   352 0000039C C7 83 0000009C 00000008         	MOV	DWORD [156+EBX],8
   353 000003A6 C7 43 5C 00268000               	MOV	DWORD [92+EBX],2523136
   354 000003AD C7 83 0000010E 00000000         	MOV	DWORD [270+EBX],0
   355 000003B7 C7 83 0000010A 00000000         	MOV	DWORD [266+EBX],0
   356 000003C1 C7 83 00000136 [0000001C]       	MOV	DWORD [310+EBX],LC2
   357 000003CB 6A 01                           	PUSH	1
   358 000003CD 6A 09                           	PUSH	9
   359 000003CF 53                              	PUSH	EBX
   360 000003D0 E8 00000154                     	CALL	_task_run
   361 000003D5 53                              	PUSH	EBX
   362 000003D6 56                              	PUSH	ESI
   363 000003D7 C7 05 [00000008] 00000001       	MOV	DWORD [_task_ready],1
   364 000003E1 E8 FFFFFC4E                     	CALL	_add_child_task
   365 000003E6 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   366 000003E9 5B                              	POP	EBX
   367 000003EA 89 F0                           	MOV	EAX,ESI
   368 000003EC 5E                              	POP	ESI
   369 000003ED 5F                              	POP	EDI
   370 000003EE 5D                              	POP	EBP
   371 000003EF C3                              	RET
   372 000003F0                                 	GLOBAL	_task_alloc
   373 000003F0                                 _task_alloc:
   374 000003F0 55                              	PUSH	EBP
   375 000003F1 31 D2                           	XOR	EDX,EDX
   376 000003F3 89 E5                           	MOV	EBP,ESP
   377 000003F5 53                              	PUSH	EBX
   378 000003F6 31 DB                           	XOR	EBX,EBX
   379 000003F8                                 L99:
   380 000003F8 8B 0D [00000000]                	MOV	ECX,DWORD [_taskctl]
   381 000003FE 8D 04 11                        	LEA	EAX,DWORD [ECX+EDX*1]
   382 00000401 83 B8 00001001 00               	CMP	DWORD [4097+EAX],0
   383 00000408 74 14                           	JE	L102
   384 0000040A 43                              	INC	EBX
   385 0000040B 81 C2 0000013A                  	ADD	EDX,314
   386 00000411 81 FB 000003E7                  	CMP	EBX,999
   387 00000417 7E DF                           	JLE	L99
   388 00000419 31 C0                           	XOR	EAX,EAX
   389 0000041B                                 L93:
   390 0000041B 5B                              	POP	EBX
   391 0000041C 5D                              	POP	EBP
   392 0000041D C3                              	RET
   393 0000041E                                 L102:
   394 0000041E 05 00000FFD                     	ADD	EAX,4093
   395 00000423 C7 40 04 00000001               	MOV	DWORD [4+EAX],1
   396 0000042A C7 40 64 00000202               	MOV	DWORD [100+EAX],514
   397 00000431 C7 40 68 00000000               	MOV	DWORD [104+EAX],0
   398 00000438 C7 40 6C 00000000               	MOV	DWORD [108+EAX],0
   399 0000043F C7 40 70 00000000               	MOV	DWORD [112+EAX],0
   400 00000446 C7 40 74 00000000               	MOV	DWORD [116+EAX],0
   401 0000044D C7 40 7C 00000000               	MOV	DWORD [124+EAX],0
   402 00000454 C7 80 00000080 00000000         	MOV	DWORD [128+EAX],0
   403 0000045E C7 80 00000084 00000000         	MOV	DWORD [132+EAX],0
   404 00000468 C7 80 00000088 00000000         	MOV	DWORD [136+EAX],0
   405 00000472 C7 80 00000094 00000000         	MOV	DWORD [148+EAX],0
   406 0000047C C7 80 00000098 00000000         	MOV	DWORD [152+EAX],0
   407 00000486 C7 80 0000009C 00000000         	MOV	DWORD [156+EAX],0
   408 00000490 C7 80 000000A4 40000000         	MOV	DWORD [164+EAX],1073741824
   409 0000049A C7 40 48 00000000               	MOV	DWORD [72+EAX],0
   410 000004A1 C7 40 5C 00000000               	MOV	DWORD [92+EAX],0
   411 000004A8 C7 80 00000112 00000000         	MOV	DWORD [274+EAX],0
   412 000004B2 8B 51 05                        	MOV	EDX,DWORD [5+ECX]
   413 000004B5 89 80 00000106                  	MOV	DWORD [262+EAX],EAX
   414 000004BB 89 90 00000126                  	MOV	DWORD [294+EAX],EDX
   415 000004C1 8B 51 09                        	MOV	EDX,DWORD [9+ECX]
   416 000004C4 FF 41 05                        	INC	DWORD [5+ECX]
   417 000004C7 89 90 0000012A                  	MOV	DWORD [298+EAX],EDX
   418 000004CD FF 41 09                        	INC	DWORD [9+ECX]
   419 000004D0 C7 80 0000010E 00000000         	MOV	DWORD [270+EAX],0
   420 000004DA C7 80 0000010A 00000000         	MOV	DWORD [266+EAX],0
   421 000004E4 C7 80 0000011A 00000000         	MOV	DWORD [282+EAX],0
   422 000004EE C7 80 0000011E 00000000         	MOV	DWORD [286+EAX],0
   423 000004F8 C7 80 00000122 00000000         	MOV	DWORD [290+EAX],0
   424 00000502 C7 40 38 00000000               	MOV	DWORD [56+EAX],0
   425 00000509 C7 40 34 00000000               	MOV	DWORD [52+EAX],0
   426 00000510 C7 80 0000012E 00000000         	MOV	DWORD [302+EAX],0
   427 0000051A C7 80 00000132 00000000         	MOV	DWORD [306+EAX],0
   428 00000524 E9 FFFFFEF2                     	JMP	L93
   429 00000529                                 	GLOBAL	_task_run
   430 00000529                                 _task_run:
   431 00000529 55                              	PUSH	EBP
   432 0000052A 89 E5                           	MOV	EBP,ESP
   433 0000052C 56                              	PUSH	ESI
   434 0000052D 53                              	PUSH	EBX
   435 0000052E 8B 75 0C                        	MOV	ESI,DWORD [12+EBP]
   436 00000531 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   437 00000534 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   438 00000537 85 F6                           	TEST	ESI,ESI
   439 00000539 78 3B                           	JS	L108
   440 0000053B                                 L104:
   441 0000053B 85 C0                           	TEST	EAX,EAX
   442 0000053D 7E 03                           	JLE	L105
   443 0000053F 89 43 0C                        	MOV	DWORD [12+EBX],EAX
   444 00000542                                 L105:
   445 00000542 83 7B 04 02                     	CMP	DWORD [4+EBX],2
   446 00000546 74 20                           	JE	L109
   447 00000548                                 L106:
   448 00000548 83 7B 04 02                     	CMP	DWORD [4+EBX],2
   449 0000054C 74 0A                           	JE	L107
   450 0000054E 89 73 08                        	MOV	DWORD [8+EBX],ESI
   451 00000551 53                              	PUSH	EBX
   452 00000552 E8 FFFFFBAD                     	CALL	_task_add
   453 00000557 5A                              	POP	EDX
   454 00000558                                 L107:
   455 00000558 A1 [00000000]                   	MOV	EAX,DWORD [_taskctl]
   456 0000055D C6 40 04 01                     	MOV	BYTE [4+EAX],1
   457 00000561 8D 65 F8                        	LEA	ESP,DWORD [-8+EBP]
   458 00000564 5B                              	POP	EBX
   459 00000565 5E                              	POP	ESI
   460 00000566 5D                              	POP	EBP
   461 00000567 C3                              	RET
   462 00000568                                 L109:
   463 00000568 39 73 08                        	CMP	DWORD [8+EBX],ESI
   464 0000056B 74 DB                           	JE	L106
   465 0000056D 53                              	PUSH	EBX
   466 0000056E E8 FFFFFBBA                     	CALL	_task_remove
   467 00000573 59                              	POP	ECX
   468 00000574 EB D2                           	JMP	L106
   469 00000576                                 L108:
   470 00000576 8B 73 08                        	MOV	ESI,DWORD [8+EBX]
   471 00000579 EB C0                           	JMP	L104
   472 0000057B                                 	GLOBAL	_task_sleep
   473 0000057B                                 _task_sleep:
   474 0000057B 55                              	PUSH	EBP
   475 0000057C 89 E5                           	MOV	EBP,ESP
   476 0000057E 56                              	PUSH	ESI
   477 0000057F 53                              	PUSH	EBX
   478 00000580 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   479 00000583 83 7E 04 02                     	CMP	DWORD [4+ESI],2
   480 00000587 74 07                           	JE	L113
   481 00000589                                 L110:
   482 00000589 8D 65 F8                        	LEA	ESP,DWORD [-8+EBP]
   483 0000058C 5B                              	POP	EBX
   484 0000058D 5E                              	POP	ESI
   485 0000058E 5D                              	POP	EBP
   486 0000058F C3                              	RET
   487 00000590                                 L113:
   488 00000590 E8 FFFFFA75                     	CALL	_task_now
   489 00000595 56                              	PUSH	ESI
   490 00000596 89 C3                           	MOV	EBX,EAX
   491 00000598 E8 FFFFFB90                     	CALL	_task_remove
   492 0000059D 58                              	POP	EAX
   493 0000059E 39 DE                           	CMP	ESI,EBX
   494 000005A0 75 E7                           	JNE	L110
   495 000005A2 E8 FFFFFBEC                     	CALL	_task_switchsub
   496 000005A7 E8 FFFFFA5E                     	CALL	_task_now
   497 000005AC FF 30                           	PUSH	DWORD [EAX]
   498 000005AE 6A 00                           	PUSH	0
   499 000005B0 E8 [00000000]                   	CALL	_farjmp
   500 000005B5 5B                              	POP	EBX
   501 000005B6 5E                              	POP	ESI
   502 000005B7 EB D0                           	JMP	L110
   503 000005B9                                 	GLOBAL	_task_switch
   504 000005B9                                 _task_switch:
   505 000005B9 55                              	PUSH	EBP
   506 000005BA 89 E5                           	MOV	EBP,ESP
   507 000005BC 56                              	PUSH	ESI
   508 000005BD 53                              	PUSH	EBX
   509 000005BE 8B 1D [00000000]                	MOV	EBX,DWORD [_taskctl]
   510 000005C4 8B 13                           	MOV	EDX,DWORD [EBX]
   511 000005C6 69 D2 00000198                  	IMUL	EDX,EDX,408
   512 000005CC 8D 14 1A                        	LEA	EDX,DWORD [EDX+EBX*1]
   513 000005CF 8D 4A 0D                        	LEA	ECX,DWORD [13+EDX]
   514 000005D2 8B 41 04                        	MOV	EAX,DWORD [4+ECX]
   515 000005D5 8B 74 81 08                     	MOV	ESI,DWORD [8+ECX+EAX*4]
   516 000005D9 40                              	INC	EAX
   517 000005DA 89 41 04                        	MOV	DWORD [4+ECX],EAX
   518 000005DD 3B 42 0D                        	CMP	EAX,DWORD [13+EDX]
   519 000005E0 74 4C                           	JE	L118
   520 000005E2                                 L115:
   521 000005E2 80 7B 04 00                     	CMP	BYTE [4+EBX],0
   522 000005E6 75 2D                           	JNE	L119
   523 000005E8                                 L116:
   524 000005E8 8B 41 04                        	MOV	EAX,DWORD [4+ECX]
   525 000005EB 8B 5C 81 08                     	MOV	EBX,DWORD [8+ECX+EAX*4]
   526 000005EF FF 73 0C                        	PUSH	DWORD [12+EBX]
   527 000005F2 FF 35 [00000024]                	PUSH	DWORD [_task_timer]
   528 000005F8 E8 [00000000]                   	CALL	_timer_settime
   529 000005FD 39 F3                           	CMP	EBX,ESI
   530 000005FF 59                              	POP	ECX
   531 00000600 58                              	POP	EAX
   532 00000601 74 0B                           	JE	L114
   533 00000603 FF 33                           	PUSH	DWORD [EBX]
   534 00000605 6A 00                           	PUSH	0
   535 00000607 E8 [00000000]                   	CALL	_farjmp
   536 0000060C 58                              	POP	EAX
   537 0000060D 5A                              	POP	EDX
   538 0000060E                                 L114:
   539 0000060E 8D 65 F8                        	LEA	ESP,DWORD [-8+EBP]
   540 00000611 5B                              	POP	EBX
   541 00000612 5E                              	POP	ESI
   542 00000613 5D                              	POP	EBP
   543 00000614 C3                              	RET
   544 00000615                                 L119:
   545 00000615 E8 FFFFFB79                     	CALL	_task_switchsub
   546 0000061A 8B 15 [00000000]                	MOV	EDX,DWORD [_taskctl]
   547 00000620 8B 02                           	MOV	EAX,DWORD [EDX]
   548 00000622 69 C0 00000198                  	IMUL	EAX,EAX,408
   549 00000628 8D 4C 10 0D                     	LEA	ECX,DWORD [13+EAX+EDX*1]
   550 0000062C EB BA                           	JMP	L116
   551 0000062E                                 L118:
   552 0000062E C7 41 04 00000000               	MOV	DWORD [4+ECX],0
   553 00000635 EB AB                           	JMP	L115
   554 00000637                                 	GLOBAL	_task_lanch
   555 00000637                                 _task_lanch:
   556 00000637 55                              	PUSH	EBP
   557 00000638 89 E5                           	MOV	EBP,ESP
   558 0000063A 5D                              	POP	EBP
   559 0000063B C3                              	RET
   560 0000063C                                 	GLOBAL	_task_get_index
   561 0000063C                                 _task_get_index:
   562 0000063C 55                              	PUSH	EBP
   563 0000063D 89 E5                           	MOV	EBP,ESP
   564 0000063F 5D                              	POP	EBP
   565 00000640 C3                              	RET
   566 00000641                                 	GLOBAL	_task_get_msg
   567 00000641                                 _task_get_msg:
   568 00000641 55                              	PUSH	EBP
   569 00000642 83 C8 FF                        	OR	EAX,-1
   570 00000645 89 E5                           	MOV	EBP,ESP
   571 00000647 8B 4D 08                        	MOV	ECX,DWORD [8+EBP]
   572 0000064A 8B 51 34                        	MOV	EDX,DWORD [52+ECX]
   573 0000064D 85 D2                           	TEST	EDX,EDX
   574 0000064F 74 0B                           	JE	L122
   575 00000651 8B 42 1C                        	MOV	EAX,DWORD [28+EDX]
   576 00000654 FF 49 30                        	DEC	DWORD [48+ECX]
   577 00000657 89 41 34                        	MOV	DWORD [52+ECX],EAX
   578 0000065A 89 D0                           	MOV	EAX,EDX
   579 0000065C                                 L122:
   580 0000065C 5D                              	POP	EBP
   581 0000065D C3                              	RET
   582 0000065E                                 	GLOBAL	_task_send_msg
   583 0000065E                                 _task_send_msg:
   584 0000065E 55                              	PUSH	EBP
   585 0000065F 89 E5                           	MOV	EBP,ESP
   586 00000661 8B 55 0C                        	MOV	EDX,DWORD [12+EBP]
   587 00000664 8B 4D 10                        	MOV	ECX,DWORD [16+EBP]
   588 00000667 F6 42 38 01                     	TEST	BYTE [56+EDX],1
   589 0000066B 75 05                           	JNE	L128
   590 0000066D 83 C8 FF                        	OR	EAX,-1
   591 00000670                                 L125:
   592 00000670 C9                              	LEAVE
   593 00000671 C3                              	RET
   594 00000672                                 L128:
   595 00000672 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   596 00000675 8B 80 0000012A                  	MOV	EAX,DWORD [298+EAX]
   597 0000067B 89 41 14                        	MOV	DWORD [20+ECX],EAX
   598 0000067E 8B 82 0000012A                  	MOV	EAX,DWORD [298+EDX]
   599 00000684 89 41 14                        	MOV	DWORD [20+ECX],EAX
   600 00000687 8B 42 34                        	MOV	EAX,DWORD [52+EDX]
   601 0000068A 89 41 1C                        	MOV	DWORD [28+ECX],EAX
   602 0000068D 8D 42 10                        	LEA	EAX,DWORD [16+EDX]
   603 00000690 89 4A 34                        	MOV	DWORD [52+EDX],ECX
   604 00000693 FF 72 2C                        	PUSH	DWORD [44+EDX]
   605 00000696 50                              	PUSH	EAX
   606 00000697 E8 [00000000]                   	CALL	_fifo32_put
   607 0000069C 31 C0                           	XOR	EAX,EAX
   608 0000069E EB D0                           	JMP	L125
   609 000006A0                                 	GLOBAL	_task_msg_init
   610 000006A0                                 _task_msg_init:
   611 000006A0 55                              	PUSH	EBP
   612 000006A1 89 E5                           	MOV	EBP,ESP
   613 000006A3 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   614 000006A6 8B 55 0C                        	MOV	EDX,DWORD [12+EBP]
   615 000006A9 89 50 2C                        	MOV	DWORD [44+EAX],EDX
   616 000006AC C7 40 30 00000000               	MOV	DWORD [48+EAX],0
   617 000006B3 C7 40 38 00000001               	MOV	DWORD [56+EAX],1
   618 000006BA C7 40 3C 00000000               	MOV	DWORD [60+EAX],0
   619 000006C1 C7 40 34 00000000               	MOV	DWORD [52+EAX],0
   620 000006C8 5D                              	POP	EBP
   621 000006C9 C3                              	RET
   622 000006CA                                 	GLOBAL	_task_timer
   623                                          [SECTION .data]
   624 00000021 00 00 00                        	ALIGNB	4
   625 00000024                                 _task_timer:
   626 00000024 00 00 00 00                     	RESB	4
